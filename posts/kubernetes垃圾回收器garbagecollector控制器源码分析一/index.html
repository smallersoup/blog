<!doctype html><html lang=zh-cn dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰ &#183; è¿›å‡»äº‘åŸç”Ÿ</title>
<meta name=title content="kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰ &#183; è¿›å‡»äº‘åŸç”Ÿ"><meta name=description content="è¿›å‡»äº‘åŸç”Ÿï¼šæ·±å…¥æ¢ç´¢å®¹å™¨æŠ€æœ¯ã€Kubernetesã€Istioã€DevOps å®è·µã€Prometheus ç›‘æ§ã€Envoyã€Golang å¼€å‘ä»¥åŠäº‘åŸç”Ÿæ¶æ„å’Œå¾®æœåŠ¡è¶‹åŠ¿çš„ä¸“ä¸šåšå®¢ã€‚"><meta name=keywords content="kubernetes,"><link rel=canonical href=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/><link type=text/css rel=stylesheet href=/css/main.bundle.min.6a1934f2549fc14526ee16bc5d171958bd1a92bf5b90a39e40384dcf517f8ec1c46ca48a25a00b47ff5c55d3bc5fb768d894cfc3cf8baaf45abeb61062f6927c.css integrity="sha512-ahk08lSfwUUm7ha8XRcZWL0akr9bkKOeQDhNz1F/jsHEbKSKJaALR/9cVdO8X7do2JTPw8+LqvRavrYQYvaSfA=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.d9be7b9a4d8135f07bbbd18681ad970838d3bc8e366bfadc94c08c8a1dc440d95af2bd614a24366316f31d41518822a52ce8f464ed829ae27497b2241ab2cae5.js integrity="sha512-2b57mk2BNfB7u9GGga2XCDjTvI42a/rclMCMih3EQNla8r1hSiQ2YxbzHUFRiCKlLOj0ZO2CmuJ0l7IkGrLK5Q==" data-copy=å¤åˆ¶ data-copied=å¤åˆ¶æˆåŠŸï¼></script><script src=/lib/zoom/zoom.min.f592a181a15d2a5b042daa7f746c3721acf9063f8b6acd175d989129865a37d400ae0e85b640f9ad42cd98d1f8ad30931718cf8811abdcc5fcb264400d1a2b0c.js integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/"><meta property="og:site_name" content="è¿›å‡»äº‘åŸç”Ÿ"><meta property="og:title" content="kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰"><meta property="og:description" content="kubernetesç‰ˆæœ¬ï¼š1.13.2
èƒŒæ™¯ # ç”±äºoperatoråˆ›å»ºçš„redisé›†ç¾¤ï¼Œåœ¨kubernetes apiserveré‡å¯åï¼Œredisé›†ç¾¤è¢«å¼‚å¸¸åˆ é™¤ï¼ˆåŒ…æ‹¬redis exporter statefulsetã€redis statefulsetï¼‰ã€‚åˆ é™¤åoperatorå°†å…¶é‡å»ºï¼Œé‡æ–°ç»„å»ºé›†ç¾¤ï¼Œå®ä¾‹IPå‘ç”Ÿå˜æ›´ï¼ˆä¸­é—´ä»¶å®¹å™¨åŒ–ï¼Œæˆ‘ä»¬å¼€å‘äº†å›ºå®šIPï¼Œå½“statefulsetåˆ é™¤åï¼ŒIPä¼šè¢«å›æ”¶ï¼‰ï¼Œå¯¼è‡´åˆ›å»ºé›†ç¾¤å¤±è´¥ï¼Œæœ€ç»ˆé›†ç¾¤ä¸å¯ç”¨ã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-16T23:14:24+00:00"><meta property="article:modified_time" content="2019-10-16T23:14:24+00:00"><meta property="article:tag" content="Kubernetes"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰"><meta name=twitter:description content="kubernetesç‰ˆæœ¬ï¼š1.13.2
èƒŒæ™¯ # ç”±äºoperatoråˆ›å»ºçš„redisé›†ç¾¤ï¼Œåœ¨kubernetes apiserveré‡å¯åï¼Œredisé›†ç¾¤è¢«å¼‚å¸¸åˆ é™¤ï¼ˆåŒ…æ‹¬redis exporter statefulsetã€redis statefulsetï¼‰ã€‚åˆ é™¤åoperatorå°†å…¶é‡å»ºï¼Œé‡æ–°ç»„å»ºé›†ç¾¤ï¼Œå®ä¾‹IPå‘ç”Ÿå˜æ›´ï¼ˆä¸­é—´ä»¶å®¹å™¨åŒ–ï¼Œæˆ‘ä»¬å¼€å‘äº†å›ºå®šIPï¼Œå½“statefulsetåˆ é™¤åï¼ŒIPä¼šè¢«å›æ”¶ï¼‰ï¼Œå¯¼è‡´åˆ›å»ºé›†ç¾¤å¤±è´¥ï¼Œæœ€ç»ˆé›†ç¾¤ä¸å¯ç”¨ã€‚"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰","headline":"kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰","abstract":"\u003cp\u003e\n\n\n\n\n\n  \u003cfigure\u003e\n    \u003cimg class=\u0022my-0 rounded-md\u0022 loading=\u0022lazy\u0022 src=\u0022https:\/\/img.hacpai.com\/bing\/20190604.jpg?imageView2\/1\/w\/960\/h\/540\/interlace\/1\/q\/100\u0022 alt=\u0022å›¾ç‰‡æè¿°: 100\u0022 \/\u003e\n    \n  \u003c\/figure\u003e\n\u003c\/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003ekubernetesç‰ˆæœ¬ï¼š1.13.2\u003c\/strong\u003e\u003c\/p\u003e\u003c\/blockquote\u003e\n\n\u003ch2 class=\u0022relative group\u0022\u003eèƒŒæ™¯ \n    \u003cdiv id=\u0022èƒŒæ™¯\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\u0022\u003e\n        \u003ca class=\u0022group-hover:text-primary-300 dark:group-hover:text-neutral-700\u0022\n            style=\u0022text-decoration-line: none !important;\u0022 href=\u0022#%e8%83%8c%e6%99%af\u0022 aria-label=\u0022é”šç‚¹\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e        \n    \n\u003c\/h2\u003e\n\u003cp\u003eç”±äºoperatoråˆ›å»ºçš„redisé›†ç¾¤ï¼Œåœ¨kubernetes apiserveré‡å¯åï¼Œredisé›†ç¾¤è¢«å¼‚å¸¸åˆ é™¤ï¼ˆåŒ…æ‹¬redis exporter statefulsetã€redis statefulsetï¼‰ã€‚åˆ é™¤åoperatorå°†å…¶é‡å»ºï¼Œé‡æ–°ç»„å»ºé›†ç¾¤ï¼Œå®ä¾‹IPå‘ç”Ÿå˜æ›´ï¼ˆä¸­é—´ä»¶å®¹å™¨åŒ–ï¼Œæˆ‘ä»¬å¼€å‘äº†å›ºå®šIPï¼Œå½“statefulsetåˆ é™¤åï¼ŒIPä¼šè¢«å›æ”¶ï¼‰ï¼Œå¯¼è‡´åˆ›å»ºé›†ç¾¤å¤±è´¥ï¼Œæœ€ç»ˆé›†ç¾¤ä¸å¯ç”¨ã€‚\u003c\/p\u003e","inLanguage":"zh-cn","url":"https:\/\/kubeinfo.cn\/posts\/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80\/","author":{"@type":"Person","name":""},"copyrightYear":"2019","dateCreated":"2019-10-16T23:14:24\u002b00:00","datePublished":"2019-10-16T23:14:24\u002b00:00","dateModified":"2019-10-16T23:14:24\u002b00:00","keywords":["kubernetes"],"mainEntityOfPage":"true","wordCount":"6943"}]</script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><script data-id=umami-script async src=https://analytics.umami.is/script.js data-website-id=f5c28d4b-4ab0-4edc-be58-1ecbe88bfbf5></script><script type=text/javascript>document.querySelector('script[data-id="umami-script"]').addEventListener("load",function(){const e=document.head.querySelector('meta[property = "og:type"]').getAttribute("content");let t=document.head.querySelector('meta[property = "og:title"]').getAttribute("content"),n=document.head.querySelector('meta[property = "og:url"]').getAttribute("content");umami.track(e+":"+t,{url:n})})</script><script>document.addEventListener("DOMContentLoaded",function(){var e=document.createElement("link");e.href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css",e.rel="stylesheet",document.head.appendChild(e)})</script><div id=fps style=z-index:999;position:fixed;bottom:3px;right:3px;color:#fff;font-size:10px></div><script defer type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/layer/3.5.1/layer.min.js></script><script defer type=text/javascript src=https://kubeinfo.cn/js/fps.js></script><script defer>window.addEventListener("scroll",function e(){window.scrollY>100&&(function(e,t,n,s){if(typeof e.webpushr!="undefined")return;e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var i=t.getElementsByTagName(n)[0],o=t.createElement(n);o.id=s,o.async=1,o.src="https://cdn.webpushr.com/app.min.js",i.parentNode.appendChild(o)}(window,document,"script","webpushr-jssdk"),webpushr("setup",{key:"BPaSgcviMxfkNlELfboefkjPEigiszIStgrZEfmp4nsCSXMzLpCphJai8hTOl1o0_yg8u6-SxNz98pdSGro05C4"}),window.removeEventListener("scroll",e))})</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",e=>{const t="https://htr4n1.laf.run/baidu-seo?urls="+window.location.href;fetch(t).then(e=>e.json()).then(e=>{const t=JSON.parse(e.body);t.remain>0&&t.success===1?console.log("ç™¾åº¦æ”¶å½•æäº¤æˆåŠŸï¼Œå½“å‰apiä½™å‰©æ¬¡æ•°ï¼š"+t.remain):(t.remain===0?console.log("å·²è¾¾åˆ°ä»Šæ—¥ç™¾åº¦æäº¤ä¸Šé™ã€‚"):(console.log(t.remain),console.log("apiæäº¤å¤±è´¥")),t.not_same_site&&console.log("æœªæ”¶å½•çš„ç«™ç‚¹ï¼š",t.not_same_site.join(", ")))}).catch(e=>{console.error("è¯·æ±‚å¤±è´¥ï¼Œä½†è¿™å¯èƒ½æ˜¯å› ä¸ºè¾¾åˆ°æäº¤ä¸Šé™:",e)})})</script><script defer>function loadScriptOnScroll(){var e,t,n,s=window.scrollY||window.pageYOffset;s>100&&(n=n||[],e=document.createElement("script"),e.src="https://hm.baidu.com/hm.js?efe96f04908ae320df234a4f5626879e",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t),window.removeEventListener("scroll",loadScriptOnScroll))}window.addEventListener("scroll",loadScriptOnScroll)</script><script defer>function loadAnalyticsScript(){var e=document.createElement("script");e.async=!0,e.src="https://ga.kubeinfo.cn/gtag/js?id=G-0VHVXWXJMQ",document.head.appendChild(e),window.dataLayer=window.dataLayer||[];function t(){dataLayer.push(arguments)}t("js",new Date),t("config","G-0VHVXWXJMQ"),window.removeEventListener("scroll",onScrollLoadAnalytics)}function onScrollLoadAnalytics(){window.scrollY>100&&loadAnalyticsScript()}window.addEventListener("scroll",onScrollLoadAnalytics)</script><script defer>function loadClarityScript(){(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","m535olg9md"),window.removeEventListener("scroll",onScrollLoadClarity)}function onScrollLoadClarity(){window.scrollY>100&&loadClarityScript()}window.addEventListener("scroll",onScrollLoadClarity)</script><div class=top-scroll-bar style=height:5px;background-color:blue;width:0;position:fixed;top:0;z-index:100></div><script type=text/javascript>$(document).ready(function(){$(window).scroll(function(){$(".top-scroll-bar").attr("style","width: "+$(this).scrollTop()/($(document).height()-$(this).height())*100+"%; display: block;")})})</script><script src=https://cdn.jsdelivr.net/gh/instantpage/instant.page@master/instantpage.js type=module></script><script type=text/javascript>var titleTime,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="è€æ¿åˆ«èµ°å– Î£(ã£ Â°Ğ” Â°;)ã£",clearTimeout(titleTime)):(document.title="è€æ¿æ‚¨å¯ç®—å›æ¥äº† (ï½¡â€¢Ë‡â€¸Ë‡â€¢ï½¡)"+OriginTitile,titleTime=setTimeout(function(){document.title=OriginTitile},2e3))})</script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>è·³è¿‡æ­£æ–‡</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><img src=/img/logo.jpeg width=443 height=443 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=è¿›å‡»äº‘åŸç”Ÿ></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900"><h6 style=font-size:1.5rem><span style=color:#abd123>>$</span>&nbsp;cd /home/<span class=logo_cursor></span></h6></a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title>é¡¹ç›®</p></a><a href="https://cloud.umami.is/share/h5GReomkOf4fsBGd/kubeinfo.cn?theme=dark" target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span><p class="text-base font-medium" title>å®æ—¶è®¿å®¢</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M159.3 5.4c7.8-7.3 19.9-7.2 27.7.1 27.6 25.9 53.5 53.8 77.7 84 11-14.4 23.5-30.1 37-42.9 7.9-7.4 20.1-7.4 28 .1 34.6 33 63.9 76.6 84.5 118 20.3 40.8 33.8 82.5 33.8 111.9C448 404.2 348.2 512 224 512 98.4 512 0 404.1.0 276.5c0-38.4 17.8-85.3 45.4-131.7C73.3 97.7 112.7 48.6 159.3 5.4zM225.7 416c25.3.0 47.7-7 68.8-21 42.1-29.4 53.4-88.2 28.1-134.4-2.8-5.6-5.6-11.2-9.8-16.8l-50.6 58.8S180.8 199 175.1 192c-42 51.8-63.1 81.2-63.1 114.8C112 375.4 162.6 416 225.7 416z"/></svg>
</span></span><a class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title>ç™¾å®ç®±
</a><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=https://upptime.kubeinfo.cn/ target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M228.3 469.1 47.6 300.4c-4.2-3.9-8.2-8.1-11.9-12.4h87c22.6.0 43-13.6 51.7-34.5l10.5-25.2 49.3 109.5c3.8 8.5 12.1 14 21.4 14.1s17.8-5 22-13.3L320 253.7l1.7 3.4c9.5 19 28.9 31 50.1 31H476.3c-3.7 4.3-7.7 8.5-11.9 12.4L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9s-20.2-3.9-27.7-10.9zM503.7 240h-132c-3 0-5.8-1.7-7.2-4.4l-23.2-46.3c-4.1-8.1-12.4-13.3-21.5-13.3s-17.4 5.1-21.5 13.3l-41.4 82.8-51-113.9c-3.9-8.7-12.7-14.3-22.2-14.1s-18.1 5.9-21.8 14.8l-31.8 76.3c-1.2 3-4.2 4.9-7.4 4.9H16c-2.6.0-5 .4-7.3 1.1-5.7-16-8.7-33-8.7-50.3v-5.8c0-69.9 50.5-129.5 119.4-141C165 36.5 211.4 51.4 244 84l12 12 12-12c32.6-32.6 79-47.5 124.6-39.9C461.5 55.6 512 115.2 512 185.1v5.8c0 16.9-2.8 33.5-8.3 49.1z"/></svg></span></span><p class="text-sm font-sm" title>æœåŠ¡ç›‘æ§</p></a><a href=/jstc/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M0 96C0 60.7 28.7 32 64 32H448c35.3.0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3.0-64-28.7-64-64V96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4S78.8 416 88 416h96 32H424c8.9.0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192c26.5.0 48-21.5 48-48s-21.5-48-48-48-48 21.5-48 48 21.5 48 48 48z"/></svg></span></span><p class="text-sm font-sm" title>è¶£å‘³æˆªå›¾</p></a></div></div></div></div><a href=/index.xml class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></span><p class="text-base font-medium" title=rss></p></a><a href=https://github.com/smallersoup target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span><p class="text-base font-medium" title=github></p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400" style=margin-right:5px><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg" title>é¡¹ç›®</p></a></li><li class=mt-1><a href="https://cloud.umami.is/share/h5GReomkOf4fsBGd/kubeinfo.cn?theme=dark" target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></div><p class="text-bg font-bg" title>å®æ—¶è®¿å®¢</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M159.3 5.4c7.8-7.3 19.9-7.2 27.7.1 27.6 25.9 53.5 53.8 77.7 84 11-14.4 23.5-30.1 37-42.9 7.9-7.4 20.1-7.4 28 .1 34.6 33 63.9 76.6 84.5 118 20.3 40.8 33.8 82.5 33.8 111.9C448 404.2 348.2 512 224 512 98.4 512 0 404.1.0 276.5c0-38.4 17.8-85.3 45.4-131.7C73.3 97.7 112.7 48.6 159.3 5.4zM225.7 416c25.3.0 47.7-7 68.8-21 42.1-29.4 53.4-88.2 28.1-134.4-2.8-5.6-5.6-11.2-9.8-16.8l-50.6 58.8S180.8 199 175.1 192c-42 51.8-63.1 81.2-63.1 114.8C112 375.4 162.6 416 225.7 416z"/></svg></span></span><p class="text-bg font-bg" title>ç™¾å®ç®±</p><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=https://upptime.kubeinfo.cn/ target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M228.3 469.1 47.6 300.4c-4.2-3.9-8.2-8.1-11.9-12.4h87c22.6.0 43-13.6 51.7-34.5l10.5-25.2 49.3 109.5c3.8 8.5 12.1 14 21.4 14.1s17.8-5 22-13.3L320 253.7l1.7 3.4c9.5 19 28.9 31 50.1 31H476.3c-3.7 4.3-7.7 8.5-11.9 12.4L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9s-20.2-3.9-27.7-10.9zM503.7 240h-132c-3 0-5.8-1.7-7.2-4.4l-23.2-46.3c-4.1-8.1-12.4-13.3-21.5-13.3s-17.4 5.1-21.5 13.3l-41.4 82.8-51-113.9c-3.9-8.7-12.7-14.3-22.2-14.1s-18.1 5.9-21.8 14.8l-31.8 76.3c-1.2 3-4.2 4.9-7.4 4.9H16c-2.6.0-5 .4-7.3 1.1-5.7-16-8.7-33-8.7-50.3v-5.8c0-69.9 50.5-129.5 119.4-141C165 36.5 211.4 51.4 244 84l12 12 12-12c32.6-32.6 79-47.5 124.6-39.9C461.5 55.6 512 115.2 512 185.1v5.8c0 16.9-2.8 33.5-8.3 49.1z"/></svg></span></span><p class="text-sm font-small" title>æœåŠ¡ç›‘æ§</p></a></li><li class=mt-1><a href=/jstc/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M0 96C0 60.7 28.7 32 64 32H448c35.3.0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3.0-64-28.7-64-64V96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4S78.8 416 88 416h96 32H424c8.9.0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192c26.5.0 48-21.5 48-48s-21.5-48-48-48-48 21.5-48 48 21.5 48 48 48z"/></svg></span></span><p class="text-sm font-small" title>è¶£å‘³æˆªå›¾</p></a></li><li class=mb-2></li><li class=mt-1><a href=/index.xml class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span></div><p class="text-bg font-bg" title=rss></p></a></li><li class=mt-1><a href=https://github.com/smallersoup target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></div><p class="text-bg font-bg" title=github></p></a></li></ul></div></label></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><div class=wrapper__left style=left:2px data-pad=true dir=ltr><div class="join-us dark:text-black" style=margin-top:3%;height:39%><picture><source media="(max-width: 767px)" srcset><img class="modalImage nozoom" style=max-width:13%;height:auto src=/img/sealos-logo.png alt=icon></img></picture><p><a data-umami-event=Sealos href=https://github.com/labring/sealos target=_blank>Sealos</a>ï¼Œåœ¨äº‘æ¡Œé¢ä¸­è¿è¡Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œåƒä½¿ç”¨ä¸ªäººç”µè„‘ä¸€æ ·ä½¿ç”¨äº‘</p><picture><source media="(max-width: 767px)" srcset><img class=modalImage style=max-width:80%;height:auto src=/img/sealos-desktop.webp alt=icon></img></picture><p style=margin-top:1rem!important;text-align:center><a data-umami-event=Sealos class="!rounded-md bg-primary-600 px-4 py-2 !text-neutral !no-underline hover:!bg-primary-500 dark:bg-primary-800 dark:hover:!bg-primary-700" href=https://sealos.run target=_blank role=button>å»çœ‹çœ‹ğŸ‘€</a></p></div><div class=join-us style=top:42%;height:53%><picture><source media="(max-width: 767px)" srcset><img class="modalImage nozoom" id=modalImage src=/img/modal-content.svg alt=icon></img></picture><p>æ‰«ç åŠ å…¥å¾®ä¿¡ç¾¤ï¼Œå’Œäº‘åŸç”Ÿå¤§ä½¬ä»¬ä¸€èµ·æ¢è®¨äº‘åŸç”Ÿå’Œä¸å¯æè¿°çš„äº‹æƒ…ï¼</p><div><picture><source media="(max-width: 767px)" srcset><img class=modalImage style=width:25%;height:auto;margin-top:2% src=/img/wechat-qr-code.jpg alt="wechat qr code"></img></picture></div><button class=button_left>
<a data-umami-event="Telegram cloud_native_share" href=https://t.me/cloudnativer target=_blank title="Telegram cloud_native_share"><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>åŠ å…¥ Telegram</p></button>
<button class=button_left>
<a data-umami-event="Telegram cloud_native_share" href=https://t.me/cloud_native_share target=_blank title="Telegram cloud_native_share"><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>é»‘ç§‘æŠ€å¹¿æ’­ç«™</p></button>
<button class=button_left>
<a data-umami-event="Telegram cloud_native_blogs" href=https://t.me/cloud_native_blogs target=_blank title="Telegram cloud_native_blogs"><div class=icon_left><svg viewBox="0 0 16 16" class="bi bi-telegram" fill="currentcolor" height="16" width="16"><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.287 5.906c-.778.324-2.334.994-4.666 2.01-.378.15-.577.298-.595.442-.03.243.275.339.69.47l.175.055c.408.133.958.288 1.243.294.26.006.549-.1.868-.32 2.179-1.471 3.304-2.214 3.374-2.23.05-.012.12-.026.166.016.047.041.042.12.037.141-.03.129-1.227 1.241-1.846 1.817-.193.18-.33.307-.358.336a8.154 8.154.0 01-.188.186c-.38.366-.664.64.015 1.088.327.216.589.393.85.571.284.194.568.387.936.629.093.06.183.125.27.187.331.236.63.448.997.414.214-.02.435-.22.547-.82.265-1.417.786-4.486.906-5.751a1.426 1.426.0 00-.013-.315.337.337.0 00-.114-.217.526.526.0 00-.31-.093c-.3.005-.763.166-2.984 1.09z"/></svg></div></a><p>é«˜æ‰‹åšå®¢æ”¶è—å¤¹</p></button></div></div><div class=wrapper__right style=right:2px data-pad=true dir=ltr><div class="join-us dark:text-black" style=margin-top:3%;height:24%><div class=modalImage style=font-size:1.125rem!important><span>é‡ç£…æ¨èâ—</span></div><a data-umami-event=mkdirs href="https://mkdirs.com?via=carsonyang" target=_blank title="mkdirs å¯¼èˆªç«™æ¨¡æ¿"><picture><source media="(max-width: 767px)" srcset><img class="modalImage nozoom" style=max-width:80%;height:auto src=https://images.kubeinfo.cn/uPic/2024-12-20-19-35-mMvvtA.jpeg alt=icon></img></picture></a></div><div id=tiangou class="join-us dark:text-black" style=top:26%><svg style="display:inline-block" viewBox="0 0 1024 1024" width="22" height="22" fill="currentcolor"><path d="M774.144 734.72c-35.328 60.416-99.84 93.696-176.64 74.752-1.024 29.696-12.288 54.784-36.352 72.704-15.36 11.264-33.28 16.896-51.712 15.872-47.616-1.536-75.264-30.72-85.504-88.064-74.752 15.36-132.608-8.704-173.056-72.192-17.92 3.584-35.84 9.216-53.76 10.752-63.488 5.12-107.52-28.16-122.88-90.112-12.288-49.152-7.68-98.816 5.12-146.944 34.304-130.048 102.4-238.08 213.504-315.392 146.944-102.912 333.312-93.184 471.552 24.576C865.792 307.2 928.768 416.768 952.832 547.84c6.144 34.816 6.656 70.144-1.024 104.96-20.48 94.72-100.864 110.592-166.4 86.016-3.584-.512-7.168-2.048-11.264-4.096zm-235.008-46.592c11.776 41.984 46.592 71.68 90.112 76.288 42.496 4.096 82.432-17.92 102.912-55.296 3.072-6.144 3.072-10.752.512-17.92-6.144-16.384-14.336-33.792-14.848-51.2-2.048-86.016-2.048-172.032-2.56-258.048.0-15.872 8.704-24.576 23.04-24.064 13.824.512 20.992 8.704 20.992 24.576l1.536 240.64c0 6.144.0 12.288.512 18.432 1.536 15.872 7.168 30.208 19.456 40.96 40.448 36.864 104.96 19.456 120.32-32.768 8.704-30.208 8.704-60.928 3.584-91.136-20.48-117.248-75.776-216.064-164.352-295.424-119.296-106.496-277.504-121.344-408.064-36.352-117.76 76.8-184.832 188.416-211.968 324.608-6.656 33.792-7.168 68.608 4.096 101.888 8.192 23.552 22.528 40.96 48.128 46.08 54.784 10.752 92.16-19.456 92.16-75.264V614.4c0-76.8.0-153.088.512-229.888.0-17.92 8.192-27.136 23.04-26.624 14.336.0 21.504 9.216 22.016 26.624.0 12.8-.512 25.6-.512 37.888.0 69.12-.512 138.24-.512 207.36.0 22.528-5.12 43.52-16.384 63.488-2.048 4.096-2.56 11.264-.512 15.36 29.696 59.904 111.104 75.264 160.768 30.72 16.384-14.848 28.16-32.256 32.256-50.688-14.336-13.312-26.624-25.088-39.424-36.864-15.36-14.336-17.92-31.744-12.288-50.688 5.632-19.968 19.456-33.792 39.424-35.84 25.6-2.56 51.712-2.048 77.312.0 19.456 1.536 32.256 15.36 38.4 33.792 5.632 16.896 5.632 33.792-7.168 47.616-11.776 14.336-26.624 26.624-42.496 41.472zm-50.176 85.504c-18.944 13.312-24.064 30.208-16.384 51.712 6.144 17.92 23.552 29.184 41.472 27.648 18.944-1.536 33.28-14.336 37.376-33.28 5.632-26.112 2.56-35.328-15.872-45.056-1.024 9.216-.512 18.944-2.56 27.648-2.56 10.24-11.264 14.848-21.504 14.848-15.36.512-19.968-8.192-22.528-43.52z"/><path d="M391.168 496.64c-20.992.0-37.376-16.896-36.864-37.376.512-20.48 17.92-36.864 38.4-36.352 19.968.512 35.84 16.896 35.84 37.376.512 20.48-15.872 36.352-37.376 36.352zm282.624-31.744c0 20.48-15.872 36.864-36.352 36.864-20.992.0-37.888-16.384-37.376-37.376.512-20.48 16.384-36.864 36.864-36.864 20.992-.512 36.864 15.872 36.864 37.376z"/></svg>
&nbsp;<div class=modalImage style=font-size:1.125rem!important><span>èˆ”ç‹—æ—¥è®°</span></div><p id=apiData class="content type3"></p><div class=change><svg id="refreshButton" class="modalImage" viewBox="0 0 1024 1024" width="25" height="25" fill="currentcolor"><path d="M1000.61 625.5c-24.6-33.4-55.3-155.5-69.3-231.5-3.8-20.6-18.7-36.9-38.8-42.6-4-1.1-8.1-1.8-12.2-1.9-35.3-59-74.5-66.7-100.5-71.8-18.5-3.6-18.8-4.5-21.5-11.1-13.1-32.1-32.3-54-57.1-65.1-20.8-9.4-41.4-9.2-53.7-9.2-.9.0-2-.2-3.2-.5-.8-.2-1.6-.3-2.4-.4-39.3-56.7-70.7-68.1-108.5-68.1h-.2c-38.1.0-63 21-81.2 36.4l-1.6 1.4c-21.3 18-24.9 18.8-33.7 15.2-45.3-18.6-84.6-8.1-116.8 31-13.6 16.6-20.7 29-25.4 37.1l-.1.2c-5.1-.7-10.3-1.6-15.4-2.5-27.5-4.9-51.8 6.7-72.4 34.5-16.7 22.5-27.7 51.7-34.2 73.1-1.7-.2-3.3-.3-5-.3-27.1.0-50.4 20.3-54 47.2-5.5 39.8-15.3 87.4-26.2 127.3-13.4 48.9-27.5 83.2-40.8 99.3-27.6 33.4-28.7 66.5-24.7 88.4 6.7 37.3 34.9 73.7 75.5 97.3 55.3 32.2 158.1 92 447 92 268 0 356.3-52.2 414.8-86.8l2.2-1.3c2.3-1.4 4.5-2.7 6.8-4 18.6-10.8 63-41.6 73.8-93.3 4.4-21.8 4.5-55-21.2-90zM919.01 759c-3 1.8-6.1 3.6-9.3 5.5-27.1 16-60.7 35.9-118.5 51.5-67.9 18.3-155.2 27.2-266.9 27.2-273.4.0-367.5-54.8-418.1-84.2-20.2-11.8-43.4-33.1-47.8-57.7-2.6-14.5 1.6-28.5 12.5-41.6 22.3-27 42.5-78.2 60-152.3 10.3-43.7 16.6-82.8 18.8-97.2 28.9 25.2 104.2 42.6 148.1 51 73.8 14.1 161.6 22.5 234.9 22.5 68.4.0 140.7-7.1 203.7-20.1 62.7-12.9 110.4-30.4 134.6-49.3 1.9-.2 3.7-.6 5.5-1.2 7.7 39.5 39.9 194.9 77.8 246.5 10.6 14.4 14.3 29.2 11.2 44.2-4.3 20.1-21.7 40.8-46.5 55.2zm-271.3-509.5c23.2-.1 41.5-.2 57.3 38.6 14.8 36.3 44.2 42 63.7 45.9 18.9 3.7 38.5 7.6 59.3 40.1-15.5 9-49.3 21.8-101.4 32.7v-1c-1.7-55.7-39.4-82-61.3-88.7-7.3-2.3-15.1-1.5-21.9 2.1s-11.8 9.6-14.1 17c-4.7 15.2 3.9 31.3 19 35.9.8.3 19.9 6.8 20.7 35.5.1 3 .7 6 1.8 9-45.5 6.3-91.7 9.6-137.6 9.6h-.8c-68 0-150.1-7.7-219.4-20.6-60.1-11.2-93.1-22.8-108.5-29.4 11.5-43.5 32-79.4 44.4-77.4 38.1 6.7 55.8 8.2 75.1-25.2 4-6.9 9.5-16.4 20.3-29.6 17.9-21.8 31.6-21.8 50.4-14.1 42.5 17.4 70.8-6.5 91.5-24l3.7-3.1c14-11.8 26.1-22.1 43.3-22.1 18.3.0 32.8.0 65.4 49.3.0.1.1.2.1.3.2.5.4 1 .7 1.5 13 17.6 32.6 17.7 48.3 17.7z"/><path d="M197.61 503.7c-15.7-2.2-30.3 8.9-32.4 24.6-3.6 25.7-10.5 55.9-18.6 80.8-9.8 30.3-20.5 50.7-30.8 59.1-6 4.8-9.9 11.6-10.8 19.2-.9 7.6 1.2 15.2 6 21.2s11.6 9.9 19.2 10.8c1.2.1 2.3.2 3.5.2 6.4.0 12.6-2.1 17.7-6.2.2-.2.4-.3.6-.5 21.2-17.1 39.2-50.4 53.4-98.8 11-37.4 16-71.6 16.9-78.1 2-15.6-9-30.2-24.7-32.3zm234.9-238.6c-6.6-4-14.3-5.2-21.8-3.4l-.4.1c-55.8 13.8-74.3 65.3-76.5 93.6-.6 7.7 1.9 15.1 6.9 20.9 5 5.8 12 9.4 19.6 9.9h.1c.7.1 1.4.1 2.1.1 14.9.0 27.5-11.5 28.7-26.6.0-.3 3.2-34.7 32.9-42.1 7.5-1.8 13.8-6.4 17.8-13s5.2-14.3 3.4-21.8c-1.6-7.4-6.2-13.7-12.8-17.7zm144.2 34.3c-1.8.4-18 3.3-28.7-18.6-6.9-14.3-24.2-20.2-38.5-13.3-6.9 3.4-12.1 9.2-14.6 16.5s-2 15.1 1.3 22c22.5 46.2 61.9 51.2 77.8 51.2 5.8.0 11.4-.6 16.2-1.8 7.5-1.8 13.8-6.4 17.8-13s5.2-14.3 3.4-21.8c-1.8-7.5-6.4-13.8-13-17.8s-14.3-5.2-21.7-3.4z"/></svg></div></div><script defer>function fetchData(){fetch("https://api.suyanw.cn/api/tiangou?type=json").then(e=>e.json()).then(e=>{const t=e.text;document.getElementById("apiData").innerText=t,adjustContainerHeight(t)}).catch(e=>console.error("Error:",e))}function adjustContainerHeight(e){const t=180,n=1.2,s=t+e.length*n;document.getElementById("tiangou").style.height=`${s}px`}document.getElementById("refreshButton").addEventListener("click",fetchData),window.matchMedia("(max-width: 768px)").matches||(document.getElementById("refreshButton").addEventListener("click",fetchData),fetchData())</script></div><main id=main-content class=grow><article><figure><img class="w-full rounded-lg single_hero_round nozoom" alt=kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰ width=1200 height=800 src=/img/ocean_hu_f78b3c25ca3bb793.jpg></figure><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>è¿›å‡»äº‘åŸç”Ÿ</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/>kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆä¸€ï¼‰</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2019-10-16T23:14:24+00:00>2019å¹´10æœˆ16æ—¥</time><span class="px-2 text-primary-500">&#183;</span><span>6943 å­—</span><span class="px-2 text-primary-500">&#183;</span><span title=é¢„è®¡é˜…è¯»>14 åˆ†é’Ÿ</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=busuanzi_page_pv></span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentcolor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
</span></span></span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/smallersoup/blog/tree/main/content/zh-cn/posts/kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%e4%b8%80.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title=ç¼–è¾‘å†…å®¹><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
</span></span></a></span><span class="px-2 text-primary-500">&#183;</span>
<script type=text/javascript src=/js/zen-mode.min.2a0a1375509c03daf41c53a9831aa2d560895b7a2528c3eb3b56e7b11a135c7529e49727162a053b6193be8340270a8342f42c69f3d7e262ae54bc248eaac8f5.js integrity="sha512-KgoTdVCcA9r0HFOpgxqi1WCJW3olKMPrO1bnsRoTXHUp5JcnFioFO2GTvoNAJwqDQvQsafPX4mKuVLwkjqrI9Q=="></script><span class=mb-[2px]><span id=zen-mode-button class="text-lg hover:text-primary-500" title=å¯ç”¨æç®€æ¨¡å¼ data-title-i18n-disable=å¯ç”¨æç®€æ¨¡å¼ data-title-i18n-enable=å…³é—­æç®€æ¨¡å¼><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentcolor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/kubernetes/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Kubernetes</span></span></span></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#æ­£æ–‡>æ­£æ–‡</a></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#æ­£æ–‡>æ­£æ–‡</a></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=decodeURIComponent(t.attr("id")))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){n()})}})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><style>.slideContent{@media(max-width:600px){display: none !important;}&>* { user-select: none; } .swiper-slide { a { height: 100%; } img { height: 100%; object-fit: cover; } }}.swiper,swiper-container{margin-left:inherit!important;margin-bottom:-30px;@media(max-width:600px){display: none !important;}}</style><script defer>document.addEventListener("DOMContentLoaded",function(){if(!window.matchMedia("(max-width: 768px)").matches){var e,t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/swiper@9.0.2/swiper-bundle.min.css",document.head.appendChild(t),e=document.createElement("script"),e.src="https://cdn.jsdelivr.net/npm/swiper@9.0.2/swiper-bundle.min.js",e.onload=function(){var e=new Swiper("#slider",{direction:"horizontal",loop:!0,autoplay:{delay:5e3},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},document.head.appendChild(e)}})</script><div class="swiper slideContent max-w-prose" id=slider><div class=swiper-wrapper><div class=swiper-slide><a data-umami-event=mkdirs href="https://mkdirs.com?via=carsonyang" target=_blank title=mkdirs><picture><source media="(min-width: 768px)" srcset=https://images.kubeinfo.cn/uPic/2024-12-20-19-35-mMvvtA.jpeg><img class=nozoom id=support-img src style=border:none;width:100%;max-width:100%;height:auto;display:inline-block alt=mkdirs></picture></a></div><div class=swiper-slide><a data-umami-event=gptgod href="https://gptgod.online/#/register?invite_code=46rrqz6qzscsey1jci7sdjw95" target=_blank title=gptgod><picture><source media="(min-width: 768px)" srcset=https://images.kubeinfo.cn/uPic/2023-09-15-12-36-W4I1A8.png><img class=nozoom id=support-img src style=border:none;width:100%;max-width:100%;height:auto;display:inline-block alt=gptgod></picture></a></div><div class=swiper-slide><a data-umami-event=FastGPT href="https://cloud.fastgpt.in/?inviterId=64215e9914d068bf840141d0" target=_blank title=FastGPT><picture><source media="(min-width: 768px)" srcset="https://socialify.git.ci/labring/fastgpt/image?description=1&amp;descriptionEditable=%E5%9F%BA%E4%BA%8E%20LLM%20%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%9F%A5%E8%AF%86%E5%BA%93%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%BC%80%E7%AE%B1%E5%8D%B3%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E3%80%81%E6%A8%A1%E5%9E%8B%E8%B0%83%E7%94%A8%E7%AD%89%E8%83%BD%E5%8A%9B%E3%80%82&amp;font=Raleway&amp;forks=1&amp;logo=https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2Flabring%2FFastGPT%40main%2F.github%2Fimgs%2Flogo.svg&amp;name=1&amp;pattern=Brick%20Wall&amp;stargazers=1&amp;theme=Light"><img class=nozoom id=support-img src style=border:none;width:100%;max-width:100%;height:auto;display:inline-block alt=FastGPT></picture></a></div><div class=swiper-slide><a data-umami-event="Contact me" href=https://images.kubeinfo.cn/uPic/20200430221955.png target=_blank title="Contact me"><picture><source media="(min-width: 768px)" srcset=https://images.kubeinfo.cn/uPic/2023-02-05-16-18-ofcgZS.png><img class=nozoom id=support-img src style=border:none;width:100%;max-width:100%;height:auto;display:inline-block alt="Contact me"></picture></a></div></div><div class=swiper-button-prev></div><div class=swiper-button-next></div></div><div class="article-content max-w-prose mb-20"><p><figure><img class="my-0 rounded-md" loading=lazy src=https://img.hacpai.com/bing/20190604.jpg?imageView2/1/w/960/h/540/interlace/1/q/100 alt="å›¾ç‰‡æè¿°: 100"></figure></p><blockquote><p><strong>kubernetesç‰ˆæœ¬ï¼š1.13.2</strong></p></blockquote><h2 class="relative group">èƒŒæ™¯<div id=èƒŒæ™¯ class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e8%83%8c%e6%99%af aria-label=é”šç‚¹>#</a></span></h2><p>ç”±äºoperatoråˆ›å»ºçš„redisé›†ç¾¤ï¼Œåœ¨kubernetes apiserveré‡å¯åï¼Œredisé›†ç¾¤è¢«å¼‚å¸¸åˆ é™¤ï¼ˆåŒ…æ‹¬redis exporter statefulsetã€redis statefulsetï¼‰ã€‚åˆ é™¤åoperatorå°†å…¶é‡å»ºï¼Œé‡æ–°ç»„å»ºé›†ç¾¤ï¼Œå®ä¾‹IPå‘ç”Ÿå˜æ›´ï¼ˆä¸­é—´ä»¶å®¹å™¨åŒ–ï¼Œæˆ‘ä»¬å¼€å‘äº†å›ºå®šIPï¼Œå½“statefulsetåˆ é™¤åï¼ŒIPä¼šè¢«å›æ”¶ï¼‰ï¼Œå¯¼è‡´åˆ›å»ºé›†ç¾¤å¤±è´¥ï¼Œæœ€ç»ˆé›†ç¾¤ä¸å¯ç”¨ã€‚</p><p>ç»å¤šæ¬¡å¤ç°ï¼Œapiserveré‡å¯åï¼Œé€šè¿‡æŸ¥è¯¢redis operatoræ—¥å¿—ï¼Œå¹¶æ²¡æœ‰å‘ç°ä¸»åŠ¨å»åˆ é™¤redisé›†ç¾¤ï¼ˆredis statefulsetï¼‰ã€ç›‘æ§å®ä¾‹ï¼ˆredis exporterï¼‰ã€‚è¿›ä¸€æ­¥å»æŸ¥çœ‹kube-controller-managerçš„æ—¥å¿—ï¼Œå°†å…¶æ—¥å¿—çº§åˆ«è®¾ç½®&ndash;v=5ï¼Œç»§ç»­å¤ç°ï¼Œæœ€ç»ˆåœ¨kube-controller-manageræ—¥å¿—ä¸­å‘ç°å¦‚ä¸‹æ—¥å¿—ï¼š<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/2019090122334772.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure><br>å¯ä»¥çœ‹åˆ°æ˜¯garbage collectorè§¦å‘åˆ é™¤æ“ä½œçš„ã€‚è¿™ä¸ªé—®é¢˜åœ¨apiserveræ­£å¸¸çš„æ—¶å€™æ˜¯ä¸å­˜åœ¨ï¼Œè¦æƒ³å¼„å…¶ç©¶ç«Ÿï¼Œå°±å¾—çœ‹çœ‹kube-controller-managerå†…ç½®ç»„ä»¶garbage collectorè¿™ä¸ªæ§åˆ¶å™¨çš„é€»è¾‘ã€‚</p><p><strong>ç”±äºå†…å®¹åé•¿ï¼Œåˆ†ä¸ºå¤šèŠ‚æ¥è®²ï¼š</strong></p><ol><li><code>monitors</code>ä½œä¸ºç”Ÿäº§è€…å°†å˜åŒ–çš„èµ„æºæ”¾å…¥<code>graphChanges</code>é˜Ÿåˆ—ï¼›åŒæ—¶<code>restMapper</code>å®šæœŸæ£€æµ‹é›†ç¾¤å†…èµ„æºç±»å‹ï¼Œåˆ·æ–°<code>monitors</code></li><li><code>runProcessGraphChanges</code>ä»<code>graphChanges</code>é˜Ÿåˆ—ä¸­å–å‡ºå˜åŒ–çš„<code>item</code>ï¼Œæ ¹æ®æƒ…å†µæ”¾å…¥<code>attemptToDelete</code>é˜Ÿåˆ—ï¼›</li><li><code>runProcessGraphChanges</code>ä»<code>graphChanges</code>é˜Ÿåˆ—ä¸­å–å‡ºå˜åŒ–çš„<code>item</code>ï¼Œæ ¹æ®æƒ…å†µæ”¾å…¥<code>attemptToOrphan</code>é˜Ÿåˆ—ï¼›</li><li><code>runAttemptToDeleteWorker</code>ä»<code>attemptToDelete</code>é˜Ÿåˆ—å–å‡ºï¼Œå°è¯•åˆ é™¤åƒåœ¾èµ„æºï¼›</li><li><code>runAttemptToOrphanWorker</code>ä»<code>attemptToOrphan</code>é˜Ÿåˆ—å–å‡ºï¼Œå¤„ç†è¯¥å­¤ç«‹çš„èµ„æºï¼›<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/20190903103422219.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure></li></ol><hr><h2 class="relative group">æ­£æ–‡<div id=æ­£æ–‡ class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e6%ad%a3%e6%96%87 aria-label=é”šç‚¹>#</a></span></h2><p>æƒ³è¦å¯ç”¨<code>GC</code>ï¼Œéœ€è¦åœ¨<code>kube-apiserver</code>å’Œ<code>kube-controller-manager</code>çš„å¯åŠ¨å‚æ•°ä¸­éƒ½è®¾ç½®<code>--enable-garbage-collector</code>ä¸º<code>true</code>,<code>1.13.2</code>ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯<code>GC</code>ã€‚</p><p><strong>éœ€è¦æ³¨æ„ï¼šä¸¤ç»„ä»¶è¯¥å‚æ•°å¿…é¡»ä¿æŒåŒæ­¥ã€‚</strong></p><hr><p><code>kube-controller-manager</code>å¯åŠ¨å…¥å£ï¼Œ<code>app.NewControllerManagerCommand()</code>ä¸­åŠ è½½<code>controller manage</code>ré»˜è®¤å¯åŠ¨å‚æ•°ï¼Œåˆ›å»º<code>* cobra.Command</code>å¯¹è±¡ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nx>rand</span><span class=p>.</span><span class=nf>Seed</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>().</span><span class=nf>UnixNano</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    	<span class=c1>//åŠ è½½controller manageré»˜è®¤å¯åŠ¨å‚æ•°ï¼Œåˆ›å»º* cobra.Commandå¯¹è±¡</span>
</span></span><span class=line><span class=cl>    	<span class=nx>command</span> <span class=o>:=</span> <span class=nx>app</span><span class=p>.</span><span class=nf>NewControllerManagerCommand</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    	<span class=c1>//......çœç•¥.......</span>
</span></span><span class=line><span class=cl>    	<span class=c1>//æ‰§è¡Œcobra.commandï¼Œå¹¶å¯åŠ¨controller-manager</span>
</span></span><span class=line><span class=cl>    	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>command</span><span class=p>.</span><span class=nf>Execute</span><span class=p>();</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Fprintf</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>,</span> <span class=s>&#34;%v\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    		<span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ä»¥ä¸‹ä»£ç å¤„å»å¯åŠ¨<code>kube-controller-manager</code>ï¼š<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/20190902115228781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure><br><code>NewDefaultComponentConfig(ports.InsecureKubeControllerManagerPort)</code>åŠ è½½å„ä¸ªæ§åˆ¶å™¨çš„é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>//NewKubeControllerManagerOptionsä½¿ç”¨é»˜è®¤é…ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„KubeControllerManagerOptions</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewKubeControllerManagerOptions</span><span class=p>()</span> <span class=p>(</span><span class=o>*</span><span class=nx>KubeControllerManagerOptions</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åŠ è½½å„ä¸ªæ§åˆ¶å™¨çš„é»˜è®¤é…ç½®</span>
</span></span><span class=line><span class=cl>	<span class=nx>componentConfig</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>NewDefaultComponentConfig</span><span class=p>(</span><span class=nx>ports</span><span class=p>.</span><span class=nx>InsecureKubeControllerManagerPort</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>s</span> <span class=o>:=</span> <span class=nx>KubeControllerManagerOptions</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Generic</span><span class=p>:</span>         <span class=nx>cmoptions</span><span class=p>.</span><span class=nf>NewGenericControllerManagerConfigurationOptions</span><span class=p>(</span><span class=nx>componentConfig</span><span class=p>.</span><span class=nx>Generic</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=c1>//.....çœç•¥</span>
</span></span><span class=line><span class=cl>		<span class=nx>GarbageCollectorController</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>GarbageCollectorControllerOptions</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>ConcurrentGCSyncs</span><span class=p>:</span>      <span class=nx>componentConfig</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>ConcurrentGCSyncs</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>EnableGarbageCollector</span><span class=p>:</span> <span class=nx>componentConfig</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>EnableGarbageCollector</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=c1>//.....çœç•¥</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>//gcå¿½ç•¥çš„èµ„æºå¯¹è±¡åˆ—è¡¨</span>
</span></span><span class=line><span class=cl>	<span class=nx>gcIgnoredResources</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>GroupResource</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>garbagecollector</span><span class=p>.</span><span class=nf>DefaultIgnoredResources</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>r</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>garbagecollector</span><span class=p>.</span><span class=nf>DefaultIgnoredResources</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>gcIgnoredResources</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>gcIgnoredResources</span><span class=p>,</span> <span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>GroupResource</span><span class=p>{</span><span class=nx>Group</span><span class=p>:</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Group</span><span class=p>,</span> <span class=nx>Resource</span><span class=p>:</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Resource</span><span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>s</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>GCIgnoredResources</span> <span class=p>=</span> <span class=nx>gcIgnoredResources</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=o>&amp;</span><span class=nx>s</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// NewDefaultComponentConfigè¿”å›kube-controllerç®¡ç†å™¨é…ç½®å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewDefaultComponentConfig</span><span class=p>(</span><span class=nx>insecurePort</span> <span class=kt>int32</span><span class=p>)</span> <span class=p>(</span><span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>KubeControllerManagerConfiguration</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>scheme</span> <span class=o>:=</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NewScheme</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>kubectrlmgrschemev1alpha1</span><span class=p>.</span><span class=nf>AddToScheme</span><span class=p>(</span><span class=nx>scheme</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>KubeControllerManagerConfiguration</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nf>AddToScheme</span><span class=p>(</span><span class=nx>scheme</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>KubeControllerManagerConfiguration</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>versioned</span> <span class=o>:=</span> <span class=nx>kubectrlmgrconfigv1alpha1</span><span class=p>.</span><span class=nx>KubeControllerManagerConfiguration</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åŠ è½½é»˜è®¤å‚æ•°</span>
</span></span><span class=line><span class=cl>	<span class=nx>scheme</span><span class=p>.</span><span class=nf>Default</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>versioned</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>internal</span> <span class=o>:=</span> <span class=nx>kubectrlmgrconfig</span><span class=p>.</span><span class=nx>KubeControllerManagerConfiguration</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>scheme</span><span class=p>.</span><span class=nf>Convert</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>versioned</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>internal</span><span class=p>,</span> <span class=kc>nil</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>internal</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>internal</span><span class=p>.</span><span class=nx>Generic</span><span class=p>.</span><span class=nx>Port</span> <span class=p>=</span> <span class=nx>insecurePort</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>internal</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><pre tabindex=0><code>// æ ¹æ®Objectï¼Œè·å–æä¾›çš„é»˜è®¤å‚æ•°
func (s *Scheme) Default(src Object) {
	if fn, ok := s.defaulterFuncs[reflect.TypeOf(src)]; ok {
		fn(src)
	}
}
</code></pre><p>s.defaulterFuncsç±»å‹ä¸ºmap[reflect.Type]func(interface{})ï¼Œç”¨äºæ ¹æ®æŒ‡é’ˆç±»å‹è·å–é»˜è®¤å€¼å‡½æ•°ã€‚è¯¥mapä¸­çš„æ•°æ®ä»å“ªé‡Œæ¥çš„å‘¢ï¼Ÿ</p><p>ä»£ç ä½äºsrc\k8s.io\kubernetes\pkg\controller\apis\config\v1alpha1\zz_generated.defaults.go<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/20190902154212234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure><br>å¯ä»¥çœ‹åˆ°é»˜è®¤å‚æ•°ä¸­garbage collectorä¸­é»˜è®¤å¼€å¯gcï¼ˆEnableGarbageCollectorï¼‰ï¼Œå¹¶å‘æ•°ä¸º20ï¼ˆConcurrentGCSyncsï¼‰</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>SetDefaults_GarbageCollectorControllerConfiguration</span><span class=p>(</span><span class=nx>obj</span> <span class=o>*</span><span class=nx>kubectrlmgrconfigv1alpha1</span><span class=p>.</span><span class=nx>GarbageCollectorControllerConfiguration</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>EnableGarbageCollector</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>obj</span><span class=p>.</span><span class=nx>EnableGarbageCollector</span> <span class=p>=</span> <span class=nx>utilpointer</span><span class=p>.</span><span class=nf>BoolPtr</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>ConcurrentGCSyncs</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>obj</span><span class=p>.</span><span class=nx>ConcurrentGCSyncs</span> <span class=p>=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>å›åˆ°Runå‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†NewControllerInitializerså¯åŠ¨æ‰€æœ‰æ§åˆ¶å™¨ï¼š<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/20190902154623724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure><br>é‡ç‚¹æ¥åˆ°å¯åŠ¨garbage collectorçš„startGarbageCollectorControllerå‡½æ•°ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>startGarbageCollectorController</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>ControllerContext</span><span class=p>)</span> <span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>Handler</span><span class=p>,</span> <span class=kt>bool</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>//k8s 1.13.2ä¸­é»˜è®¤ä¸ºtrue,å¯åœ¨kube-apiserverå’Œkube-controller-managerçš„å¯åŠ¨å‚æ•°ä¸­åŠ --enable-garbage-conllector=falseè®¾ç½®</span>
</span></span><span class=line><span class=cl>	<span class=c1>//éœ€ä¿è¯è¿™ä¸¤ä¸ªç»„ä»¶ä¸­å‚æ•°å€¼ä¸€è‡´</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>!</span><span class=nx>ctx</span><span class=p>.</span><span class=nx>ComponentConfig</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>EnableGarbageCollector</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//k8så„ç§åŸç”Ÿèµ„æºå¯¹è±¡å®¢æˆ·ç«¯é›†åˆ(é»˜è®¤å¯åŠ¨å‚æ•°ä¸­ç”¨SimpleControllerClientBuilderæ„å»º)</span>
</span></span><span class=line><span class=cl>	<span class=nx>gcClientset</span> <span class=o>:=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>ClientBuilder</span><span class=p>.</span><span class=nf>ClientOrDie</span><span class=p>(</span><span class=s>&#34;generic-garbage-collector&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>discoveryClient</span> <span class=o>:=</span> <span class=nx>cacheddiscovery</span><span class=p>.</span><span class=nf>NewMemCacheClient</span><span class=p>(</span><span class=nx>gcClientset</span><span class=p>.</span><span class=nf>Discovery</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//ç”Ÿæˆrest config</span>
</span></span><span class=line><span class=cl>	<span class=nx>config</span> <span class=o>:=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>ClientBuilder</span><span class=p>.</span><span class=nf>ConfigOrDie</span><span class=p>(</span><span class=s>&#34;generic-garbage-collector&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>dynamicClient</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>dynamic</span><span class=p>.</span><span class=nf>NewForConfig</span><span class=p>(</span><span class=nx>config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Get an initial set of deletable resources to prime the garbage collector.</span>
</span></span><span class=line><span class=cl>	<span class=c1>//è·å–ä¸€ç»„åˆå§‹å¯åˆ é™¤èµ„æºä»¥å¡«å……åƒåœ¾æ”¶é›†å™¨ã€‚</span>
</span></span><span class=line><span class=cl>	<span class=nx>deletableResources</span> <span class=o>:=</span> <span class=nx>garbagecollector</span><span class=p>.</span><span class=nf>GetDeletableResources</span><span class=p>(</span><span class=nx>discoveryClient</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ignoredResources</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=nx>schema</span><span class=p>.</span><span class=nx>GroupResource</span><span class=p>]</span><span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//å¿½ç•¥gcçš„èµ„æºç±»å‹</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>r</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>ComponentConfig</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>GCIgnoredResources</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>ignoredResources</span><span class=p>[</span><span class=nx>schema</span><span class=p>.</span><span class=nx>GroupResource</span><span class=p>{</span><span class=nx>Group</span><span class=p>:</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Group</span><span class=p>,</span> <span class=nx>Resource</span><span class=p>:</span> <span class=nx>r</span><span class=p>.</span><span class=nx>Resource</span><span class=p>}]</span> <span class=p>=</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>garbageCollector</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>garbagecollector</span><span class=p>.</span><span class=nf>NewGarbageCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>dynamicClient</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>RESTMapper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>deletableResources</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ignoredResources</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>InformerFactory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>InformersStarted</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to start the generic garbage collector: %v&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Start the garbage collector.</span>
</span></span><span class=line><span class=cl>	<span class=c1>//å¯åŠ¨å‚æ•°ä¸­é»˜è®¤æ˜¯20ä¸ªåç¨‹</span>
</span></span><span class=line><span class=cl>	<span class=nx>workers</span> <span class=o>:=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>ctx</span><span class=p>.</span><span class=nx>ComponentConfig</span><span class=p>.</span><span class=nx>GarbageCollectorController</span><span class=p>.</span><span class=nx>ConcurrentGCSyncs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>//å¯åŠ¨monitorså’ŒdeleteWorkersã€orphanWorkers</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nx>garbageCollector</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>workers</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>Stop</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Periodically refresh the RESTMapper with new discovery information and sync</span>
</span></span><span class=line><span class=cl>	<span class=c1>// the garbage collector.</span>
</span></span><span class=line><span class=cl>	<span class=c1>//ä½¿ç”¨æ–°çš„å‘ç°ä¿¡æ¯å®šæœŸåˆ·æ–°RESTMapperå¹¶åŒæ­¥åƒåœ¾æ”¶é›†å™¨ã€‚</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nx>garbageCollector</span><span class=p>.</span><span class=nf>Sync</span><span class=p>(</span><span class=nx>gcClientset</span><span class=p>.</span><span class=nf>Discovery</span><span class=p>(),</span> <span class=mi>30</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>,</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>Stop</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//gcæä¾›debug dot grapä¾èµ–å…³ç³»å›¾æ¥å£</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>garbagecollector</span><span class=p>.</span><span class=nf>NewDebugHandler</span><span class=p>(</span><span class=nx>garbageCollector</span><span class=p>),</span> <span class=kc>true</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>è¯¥å‡½æ•°ä¸»è¦ä½œç”¨æœ‰ï¼š<br>1ã€deletableResources := garbagecollector.GetDeletableResources(discoveryClient)è·å–é›†ç¾¤å†…æ‰€æœ‰å¯åˆ é™¤çš„èµ„æºå¯¹è±¡ï¼›æ’é™¤æ‰å¿½ç•¥çš„èµ„æºå¯¹è±¡ã€‚<br>2ã€æ„å»ºgarbageCollectorç»“æ„ä½“å¯¹è±¡ï¼›<br>3ã€garbageCollector.Run(workers, ctx.Stop)å¯åŠ¨ä¸€ä¸ªmonitorsç”¨æ¥ç›‘å¬èµ„æºå¯¹è±¡çš„å˜åŒ–ï¼ˆå¯¹åº”çš„ç”±runProcessGraphChangesæ­»å¾ªç¯å¤„ç†ï¼‰ï¼Œå’Œé»˜è®¤20ä¸ªdeleteWorkersåç¨‹å¤„ç†å¯åˆ é™¤çš„èµ„æºå¯¹è±¡ã€20ä¸ªorphanWorkersåç¨‹å¤„ç†å­¤å„¿å¯¹è±¡ã€‚<br>4ã€garbageCollector.Sync(gcClientset.Discovery(), 30*time.Second, ctx.Stop) å®šæ—¶å»è·å–ä¸€ä¸ªé›†ç¾¤å†…æ˜¯å¦æœ‰æ–°ç±»å‹çš„èµ„æºå¯¹è±¡çš„åŠ å…¥ï¼Œå¹¶é‡æ–°åˆ·æ–°monitorsï¼Œä»¥ç›‘å¬æ–°ç±»å‹çš„èµ„æºå¯¹è±¡ã€‚<br>5ã€garbagecollector.NewDebugHandler(garbageCollector)æ³¨å†Œdebugæ¥å£ï¼Œç”¨æ¥æä¾›è·å–dotæµç¨‹å›¾æ¥å£ï¼š</p><pre tabindex=0><code>curl http://127.0.0.1:10252/debug/controllers/garbagecollector/graph?uid=11211212edsaddkqedmk12
</code></pre><p>ä½¿ç”¨graphvizæä¾›çš„dot.exeå¯ä»¥ç”Ÿæˆsvgæ ¼å¼çš„å›¾ï¼Œå¯ç”¨googleæµè§ˆå™¨æŸ¥çœ‹å¦‚ä¸‹ï¼š<br><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/20190902233525953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// curl http://127.0.0.1:10252/debug/controllers/garbagecollector/graph?uid=11211212edsaddkqedmk12</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=o>*</span><span class=nx>debugHTTPHandler</span><span class=p>)</span> <span class=nf>ServeHTTP</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>req</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>req</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>Path</span> <span class=o>!=</span> <span class=s>&#34;/graph&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>http</span><span class=p>.</span><span class=nf>Error</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>http</span><span class=p>.</span><span class=nx>StatusNotFound</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>graph</span> <span class=nx>graph</span><span class=p>.</span><span class=nx>Directed</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>uidStrings</span> <span class=o>:=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nf>Query</span><span class=p>()[</span><span class=s>&#34;uid&#34;</span><span class=p>];</span> <span class=nb>len</span><span class=p>(</span><span class=nx>uidStrings</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>uids</span> <span class=o>:=</span> <span class=p>[]</span><span class=nx>types</span><span class=p>.</span><span class=nx>UID</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>uidString</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>uidStrings</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>uids</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>uids</span><span class=p>,</span> <span class=nx>types</span><span class=p>.</span><span class=nf>UID</span><span class=p>(</span><span class=nx>uidString</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=nx>graph</span> <span class=p>=</span> <span class=nx>h</span><span class=p>.</span><span class=nx>controller</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span><span class=p>.</span><span class=nx>uidToNode</span><span class=p>.</span><span class=nf>ToGonumGraphForObj</span><span class=p>(</span><span class=nx>uids</span><span class=o>...</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>graph</span> <span class=p>=</span> <span class=nx>h</span><span class=p>.</span><span class=nx>controller</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span><span class=p>.</span><span class=nx>uidToNode</span><span class=p>.</span><span class=nf>ToGonumGraph</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//ç”Ÿæˆdotæµç¨‹å›¾æ•°æ®,ç”¨graphvizå·¥å…·ä¸­çš„dot.exeå·¥å…·è½¬æ¢ä¸ºsvgå›¾(ç”¨googleæµè§ˆå™¨æ‰“å¼€)æˆ–è€…pngå›¾</span>
</span></span><span class=line><span class=cl>	<span class=c1>//APIå‚è€ƒ:https://godoc.org/gonum.org/v1/gonum/graph</span>
</span></span><span class=line><span class=cl>	<span class=c1>//graphvizä¸‹è½½åœ°å€:https://graphviz.gitlab.io/_pages/Download/Download_windows.html</span>
</span></span><span class=line><span class=cl>	<span class=c1>//dot.exe test.dot -T svg -o test.svg</span>
</span></span><span class=line><span class=cl>	<span class=nx>data</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>dot</span><span class=p>.</span><span class=nf>Marshal</span><span class=p>(</span><span class=nx>graph</span><span class=p>,</span> <span class=s>&#34;full&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;  &#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>http</span><span class=p>.</span><span class=nf>Error</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nf>Error</span><span class=p>(),</span> <span class=nx>http</span><span class=p>.</span><span class=nx>StatusInternalServerError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>w</span><span class=p>.</span><span class=nf>Write</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>w</span><span class=p>.</span><span class=nf>WriteHeader</span><span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>StatusOK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy src="https://img-blog.csdnimg.cn/2019090223362528.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9saWFiaW8uYmxvZy5jc2RuLm5ldA==,size_16,color_FFFFFF,t_70" alt=åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°></figure><br>GarbageCollectoré€šè¿‡restMapperå®šæœŸé‡ç½®å¯åˆ é™¤çš„èµ„æºç±»å‹ï¼Œæ›´æ–°GraphBuilderä¸­çš„monitorsï¼Œmonitorså°†åˆ›å»ºæ‰€æœ‰èµ„æºç±»å‹çš„å˜æ›´é€šçŸ¥å›è°ƒå‡½æ•°ï¼Œå°†å˜åŒ–çš„èµ„æºå¯¹è±¡åŠ å…¥åˆ°GraphBuilderçš„graphChangesé˜Ÿåˆ—ï¼ŒGraphBuilderçš„runProcessGraphChanges()ä¼šä¸€ç›´ä»é˜Ÿåˆ—ä¸­è·å–å˜åŒ–ï¼Œæ„å»ºä¸€ä¸ªç¼“å­˜å¯¹è±¡ä¹‹é—´ä¾èµ–å…³ç³»çš„å›¾å½¢ï¼Œä»¥åŠè§¦å‘dependencyGraphBuilderå°†å¯èƒ½è¢«åƒåœ¾æ”¶é›†çš„å¯¹è±¡æ’é˜Ÿåˆ°<code>attemptToDelete</code>é˜Ÿåˆ—ï¼Œå¹¶å°†å…¶ä¾èµ–é¡¹éœ€è¦å­¤ç«‹çš„å¯¹è±¡æ’é˜Ÿåˆ°<code>attemptToOrphan</code>é˜Ÿåˆ—ã€‚GarbageCollectorå…·æœ‰ä½¿ç”¨è¿™ä¸¤ä¸ªé˜Ÿåˆ—çš„å·¥ä½œäººå‘˜runAttemptToDeleteWorkerå’ŒrunAttemptToOrphanWorkeræ­»å¾ªç¯ï¼Œåˆ†åˆ«ä»<code>attemptToDelete</code>é˜Ÿåˆ—å’Œ<code>attemptToOrphan</code>é˜Ÿåˆ—å–å‡ºï¼Œå‘APIæœåŠ¡å™¨å‘é€è¯·æ±‚ä»¥ç›¸åº”åœ°åˆ é™¤æ›´æ–°å¯¹è±¡ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// GarbageCollectorè¿è¡Œåå°„å™¨æ¥ç›‘è§†æ‰˜ç®¡APIå¯¹è±¡çš„æ›´æ”¹ï¼Œå°†ç»“æœæ±‡æ€»åˆ°å•çº¿ç¨‹dependencyGraphBuilderï¼Œ</span>
</span></span><span class=line><span class=cl><span class=c1>// æ„å»ºä¸€ä¸ªç¼“å­˜å¯¹è±¡ä¹‹é—´ä¾èµ–å…³ç³»çš„å›¾å½¢ã€‚ç”±å›¾å˜åŒ–è§¦å‘ï¼ŒdependencyGraphBuilderå°†å¯èƒ½è¢«åƒåœ¾æ”¶é›†çš„å¯¹è±¡</span>
</span></span><span class=line><span class=cl><span class=c1>// æ’é˜Ÿåˆ°`attemptToDelete`é˜Ÿåˆ—ï¼Œå¹¶å°†å…¶ä¾èµ–é¡¹éœ€è¦å­¤ç«‹çš„å¯¹è±¡æ’é˜Ÿåˆ°`attemptToOrphan`é˜Ÿåˆ—ã€‚</span>
</span></span><span class=line><span class=cl><span class=c1>// GarbageCollectorå…·æœ‰ä½¿ç”¨è¿™ä¸¤ä¸ªé˜Ÿåˆ—çš„å·¥ä½œäººå‘˜ï¼Œå‘APIæœåŠ¡å™¨å‘é€è¯·æ±‚ä»¥ç›¸åº”åœ°åˆ é™¤æ›´æ–°å¯¹è±¡ã€‚</span>
</span></span><span class=line><span class=cl><span class=c1>// è¯·æ³¨æ„ï¼Œè®©dependencyGraphBuilderé€šçŸ¥åƒåœ¾æ”¶é›†å™¨ç¡®ä¿åƒåœ¾æ”¶é›†å™¨ä½¿ç”¨è‡³å°‘ä¸å‘é€é€šçŸ¥ä¸€æ ·æœ€æ–°çš„å›¾å½¢è¿›è¡Œæ“ä½œã€‚</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GarbageCollector</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// resettableRESTMapperæ˜¯ä¸€ä¸ªRESTMapperï¼Œå®ƒèƒ½å¤Ÿåœ¨discoveryèµ„æºç±»å‹æ—¶é‡ç½®è‡ªå·±</span>
</span></span><span class=line><span class=cl>	<span class=nx>restMapper</span>    <span class=nx>resettableRESTMapper</span>
</span></span><span class=line><span class=cl>	<span class=c1>// dynamicClientæä¾›æ“ä½œé›†ç¾¤å†…æ‰€æœ‰èµ„æºå¯¹è±¡çš„æ¥å£æ–¹æ³•,åŒ…æ‹¬k8så†…ç½®ã€CRDç”Ÿæˆçš„è‡ªå®šä¹‰èµ„æº</span>
</span></span><span class=line><span class=cl>	<span class=nx>dynamicClient</span> <span class=nx>dynamic</span><span class=p>.</span><span class=nx>Interface</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åƒåœ¾æ”¶é›†å™¨å°è¯•åœ¨æ—¶é—´æˆç†Ÿæ—¶åˆ é™¤attemptToDeleteé˜Ÿåˆ—ä¸­çš„item</span>
</span></span><span class=line><span class=cl>	<span class=nx>attemptToDelete</span> <span class=nx>workqueue</span><span class=p>.</span><span class=nx>RateLimitingInterface</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åƒåœ¾æ”¶é›†å™¨å°è¯•å­¤ç«‹attemptToOrphané˜Ÿåˆ—ä¸­itemçš„ä¾èµ–é¡¹ï¼Œç„¶ååˆ é™¤item</span>
</span></span><span class=line><span class=cl>	<span class=nx>attemptToOrphan</span>        <span class=nx>workqueue</span><span class=p>.</span><span class=nx>RateLimitingInterface</span>
</span></span><span class=line><span class=cl>	<span class=nx>dependencyGraphBuilder</span> <span class=o>*</span><span class=nx>GraphBuilder</span>
</span></span><span class=line><span class=cl>	<span class=c1>// æœ‰ownerçš„èµ„æºå¯¹è±¡,æ‰ä¼šç»™absentOwnerCacheå¡«å……ä¸å­˜åœ¨çš„Ownerä¿¡æ¯</span>
</span></span><span class=line><span class=cl>	<span class=nx>absentOwnerCache</span> <span class=o>*</span><span class=nx>UIDCache</span>
</span></span><span class=line><span class=cl>	<span class=nx>sharedInformers</span>  <span class=nx>informers</span><span class=p>.</span><span class=nx>SharedInformerFactory</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>workerLock</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>RWMutex</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><pre tabindex=0><code>// GraphBuilderï¼šåŸºäºinformersæä¾›çš„äº‹ä»¶ï¼ŒGraphBuilderæ›´æ–°
// uidToNodeï¼Œä¸€ä¸ªç¼“å­˜æˆ‘ä»¬æ‰€çŸ¥çš„ä¾èµ–å…³ç³»çš„å›¾ï¼Œå¹¶å°†
// é¡¹æ”¾å…¥attemptToDeleteå’ŒattemptToOrphané˜Ÿåˆ—
type GraphBuilder struct {
	restMapper meta.RESTMapper

	//æ¯ä¸ªç›‘è§†å™¨åˆ—è¡¨/ç›‘è§†èµ„æºï¼Œç»“æœæ±‡é›†åˆ°dependencyGraphBuilder
	monitors    monitors
	monitorLock sync.RWMutex
	// informersStarted is closed after after all of the controllers have been initialized and are running.
	// After that it is safe to start them here, before that it is not.
	// informersStartedåœ¨æ‰€æœ‰æ§åˆ¶å™¨åˆå§‹åŒ–å¹¶è¿è¡Œåå…³é—­ã€‚ä¹‹ååœ¨è¿™é‡Œå¯åŠ¨å®ƒä»¬æ˜¯å®‰å…¨çš„ï¼Œåœ¨æ­¤ä¹‹å‰å®ƒä¸æ˜¯ã€‚
	informersStarted &lt;-chan struct{}

	// stopCh drives shutdown. When a receive from it unblocks, monitors will shut down.
	// This channel is also protected by monitorLock.
	// stopChé©±åŠ¨å™¨å…³é—­å½“æ¥è‡ªå®ƒçš„æ¥æ”¶è§£é™¤é˜»å¡æ—¶ï¼Œç›‘è§†å™¨å°†å…³é—­ã€‚ æ­¤channelä¹Ÿå—monitorLockä¿æŠ¤ã€‚
	stopCh &lt;-chan struct{}

	// running tracks whether Run() has been called.
	// it is protected by monitorLock.
	//è¿è¡Œè½¨é“æ˜¯å¦å·²è°ƒç”¨Run()å®ƒå—monitorLockä¿æŠ¤ã€‚
	running bool

	dynamicClient dynamic.Interface
	// monitors are the producer of the graphChanges queue, graphBuilder alters
	// the in-memory graph according to the changes.
	// monitoræ˜¯graphChangesé˜Ÿåˆ—çš„ç”Ÿæˆè€…ï¼ŒgraphBuilderæ ¹æ®æ›´æ”¹æ”¹å˜äº†å†…å­˜ä¸­çš„å›¾å½¢ã€‚
	graphChanges workqueue.RateLimitingInterface

	// uidToNode doesn&#39;t require a lock to protect, because only the
	// single-threaded GraphBuilder.processGraphChanges() reads/writes it.
	//uidToNodeä¸éœ€è¦é”ä¿æŠ¤ï¼Œå› ä¸ºåªæœ‰å•çº¿ç¨‹GraphBuilder.processGraphChanges()è¯»å†™å®ƒã€‚
	uidToNode *concurrentUIDToNode

	// GraphBuilder is the producer of attemptToDelete and attemptToOrphan, GC is the consumer.
	// GraphBuilderæ˜¯attemptToDeleteå’ŒattemptToOrphançš„ç”Ÿäº§è€…ï¼ŒGCæ˜¯æ¶ˆè´¹è€…ã€‚
	attemptToDelete workqueue.RateLimitingInterface
	attemptToOrphan workqueue.RateLimitingInterface

	// GraphBuilder and GC share the absentOwnerCache. Objects that are known to
	// be non-existent are added to the cached.
	// GraphBuilderå’ŒGCå…±äº«absentOwnerCacheã€‚å·²çŸ¥ä¸å­˜åœ¨çš„å¯¹è±¡å°†æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚
	absentOwnerCache *UIDCache

	//æ‰€æœ‰k8sèµ„æºå¯¹è±¡é›†çš„informer
	sharedInformers  informers.SharedInformerFactory

	//ç›‘è§†å™¨å¿½ç•¥çš„èµ„æºå¯¹è±¡é›†
	ignoredResources map[schema.GroupResource]struct{}
}
</code></pre><p>åˆ›å»ºNewGarbageCollectorç»“æ„ä½“ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewGarbageCollector</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>dynamicClient</span> <span class=nx>dynamic</span><span class=p>.</span><span class=nx>Interface</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>mapper</span> <span class=nx>resettableRESTMapper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>deletableResources</span> <span class=kd>map</span><span class=p>[</span><span class=nx>schema</span><span class=p>.</span><span class=nx>GroupVersionResource</span><span class=p>]</span><span class=kd>struct</span><span class=p>{},</span>
</span></span><span class=line><span class=cl>	<span class=nx>ignoredResources</span> <span class=kd>map</span><span class=p>[</span><span class=nx>schema</span><span class=p>.</span><span class=nx>GroupResource</span><span class=p>]</span><span class=kd>struct</span><span class=p>{},</span>
</span></span><span class=line><span class=cl>	<span class=nx>sharedInformers</span> <span class=nx>informers</span><span class=p>.</span><span class=nx>SharedInformerFactory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nx>informersStarted</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{},</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>(</span><span class=o>*</span><span class=nx>GarbageCollector</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>attemptToDelete</span> <span class=o>:=</span> <span class=nx>workqueue</span><span class=p>.</span><span class=nf>NewNamedRateLimitingQueue</span><span class=p>(</span><span class=nx>workqueue</span><span class=p>.</span><span class=nf>DefaultControllerRateLimiter</span><span class=p>(),</span> <span class=s>&#34;garbage_collector_attempt_to_delete&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>attemptToOrphan</span> <span class=o>:=</span> <span class=nx>workqueue</span><span class=p>.</span><span class=nf>NewNamedRateLimitingQueue</span><span class=p>(</span><span class=nx>workqueue</span><span class=p>.</span><span class=nf>DefaultControllerRateLimiter</span><span class=p>(),</span> <span class=s>&#34;garbage_collector_attempt_to_orphan&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>absentOwnerCache</span> <span class=o>:=</span> <span class=nf>NewUIDCache</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>gc</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>GarbageCollector</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>dynamicClient</span><span class=p>:</span>    <span class=nx>dynamicClient</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>restMapper</span><span class=p>:</span>       <span class=nx>mapper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>attemptToDelete</span><span class=p>:</span>  <span class=nx>attemptToDelete</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>attemptToOrphan</span><span class=p>:</span>  <span class=nx>attemptToOrphan</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>absentOwnerCache</span><span class=p>:</span> <span class=nx>absentOwnerCache</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>gb</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>GraphBuilder</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>dynamicClient</span><span class=p>:</span>    <span class=nx>dynamicClient</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>informersStarted</span><span class=p>:</span> <span class=nx>informersStarted</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>restMapper</span><span class=p>:</span>       <span class=nx>mapper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>graphChanges</span><span class=p>:</span>     <span class=nx>workqueue</span><span class=p>.</span><span class=nf>NewNamedRateLimitingQueue</span><span class=p>(</span><span class=nx>workqueue</span><span class=p>.</span><span class=nf>DefaultControllerRateLimiter</span><span class=p>(),</span> <span class=s>&#34;garbage_collector_graph_changes&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=nx>uidToNode</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>concurrentUIDToNode</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>uidToNode</span><span class=p>:</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=nx>types</span><span class=p>.</span><span class=nx>UID</span><span class=p>]</span><span class=o>*</span><span class=nx>node</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=nx>attemptToDelete</span><span class=p>:</span>  <span class=nx>attemptToDelete</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>attemptToOrphan</span><span class=p>:</span>  <span class=nx>attemptToOrphan</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>absentOwnerCache</span><span class=p>:</span> <span class=nx>absentOwnerCache</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>sharedInformers</span><span class=p>:</span>  <span class=nx>sharedInformers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ignoredResources</span><span class=p>:</span> <span class=nx>ignoredResources</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åˆå§‹åŒ–å„ä¸ªèµ„æºå¯¹è±¡çš„monitorsï¼Œå¯åŠ¨å„èµ„æºå¯¹è±¡çš„ç›‘å¬å™¨ï¼Œå˜åŒ–æ—¶è§¦å‘å›è°ƒï¼Œå°†å…¶åŠ å…¥graphChanges é˜Ÿåˆ—</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>gb</span><span class=p>.</span><span class=nf>syncMonitors</span><span class=p>(</span><span class=nx>deletableResources</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>utilruntime</span><span class=p>.</span><span class=nf>HandleError</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;failed to sync all monitors: %v&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>gc</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span> <span class=p>=</span> <span class=nx>gb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>gc</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ä¸»è¦åŠŸèƒ½ï¼š<br>1ã€æ„å»ºGarbageCollectorç»“æ„ä½“ï¼›<br>2ã€æ„å»ºä¾èµ–ç»“æ„å›¾ç»´æŠ¤ç»“æ„ä½“GraphBuilderï¼Œå’ŒGarbageCollectorå…±ç”¨attemptToDeleteå’ŒattemptToOrphané˜Ÿåˆ—ï¼ŒGraphBuilderä½œä¸ºç”Ÿäº§ç€å°†é€‚å½“èµ„æºæ”¾åˆ°attemptToDeleteæˆ–è€…attemptToOrphané˜Ÿåˆ—ï¼Œä¾›GarbageCollectorä¸­çš„workerè¿›è¡Œæ¶ˆè´¹ï¼›<br>3ã€åˆå§‹åŒ–å„ä¸ªèµ„æºå¯¹è±¡çš„monitorsï¼Œå¯åŠ¨å„èµ„æºå¯¹è±¡çš„ç›‘å¬å™¨ï¼Œå˜åŒ–æ—¶è§¦å‘å›è°ƒï¼Œå°†å…¶åŠ å…¥graphChanges é˜Ÿåˆ—ã€‚</p><p><code>gb.syncMonitors(deletableResources)</code>æ–¹æ³•ä¸­æœ€ä¸»è¦çš„æ˜¯<code>c, s, err := gb.controllerFor(resource, kind)</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>gb</span> <span class=o>*</span><span class=nx>GraphBuilder</span><span class=p>)</span> <span class=nf>controllerFor</span><span class=p>(</span><span class=nx>resource</span> <span class=nx>schema</span><span class=p>.</span><span class=nx>GroupVersionResource</span><span class=p>,</span> <span class=nx>kind</span> <span class=nx>schema</span><span class=p>.</span><span class=nx>GroupVersionKind</span><span class=p>)</span> <span class=p>(</span><span class=nx>cache</span><span class=p>.</span><span class=nx>Controller</span><span class=p>,</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>Store</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>handlers</span> <span class=o>:=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>ResourceEventHandlerFuncs</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// add the event to the dependencyGraphBuilder&#39;s graphChanges.</span>
</span></span><span class=line><span class=cl>		<span class=c1>// å°†äº‹ä»¶æ·»åŠ åˆ°dependencyGraphBuilderçš„graphChangesä¸­ã€‚</span>
</span></span><span class=line><span class=cl>		<span class=nx>AddFunc</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>obj</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>event</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>event</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>eventType</span><span class=p>:</span> <span class=nx>addEvent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>obj</span><span class=p>:</span>       <span class=nx>obj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>gvk</span><span class=p>:</span>       <span class=nx>kind</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>gb</span><span class=p>.</span><span class=nx>graphChanges</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=nx>UpdateFunc</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>oldObj</span><span class=p>,</span> <span class=nx>newObj</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// TODO: check if there are differences in the ownerRefs,</span>
</span></span><span class=line><span class=cl>			<span class=c1>// finalizers, and DeletionTimestamp; if not, ignore the update.</span>
</span></span><span class=line><span class=cl>			<span class=c1>//TODOï¼šæ£€æŸ¥ownerRefsï¼Œ finalizerså’ŒDeletionTimestampæ˜¯å¦å­˜åœ¨å·®å¼‚;å¦‚æœæ²¡æœ‰ï¼Œè¯·å¿½ç•¥æ›´æ–°ã€‚</span>
</span></span><span class=line><span class=cl>			<span class=nx>event</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>event</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>eventType</span><span class=p>:</span> <span class=nx>updateEvent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>obj</span><span class=p>:</span>       <span class=nx>newObj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>oldObj</span><span class=p>:</span>    <span class=nx>oldObj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>gvk</span><span class=p>:</span>       <span class=nx>kind</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>gb</span><span class=p>.</span><span class=nx>graphChanges</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=nx>DeleteFunc</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>obj</span> <span class=kd>interface</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// delta fifo may wrap the object in a cache.DeletedFinalStateUnknown, unwrap it</span>
</span></span><span class=line><span class=cl>			<span class=c1>// delta fifoå¯ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨cache.DeletedFinalStateUnknownä¸­ï¼Œè§£åŒ…å®ƒ</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>deletedFinalStateUnknown</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>obj</span><span class=p>.(</span><span class=nx>cache</span><span class=p>.</span><span class=nx>DeletedFinalStateUnknown</span><span class=p>);</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>obj</span> <span class=p>=</span> <span class=nx>deletedFinalStateUnknown</span><span class=p>.</span><span class=nx>Obj</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>event</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>event</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>eventType</span><span class=p>:</span> <span class=nx>deleteEvent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>obj</span><span class=p>:</span>       <span class=nx>obj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>gvk</span><span class=p>:</span>       <span class=nx>kind</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>gb</span><span class=p>.</span><span class=nx>graphChanges</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>shared</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>gb</span><span class=p>.</span><span class=nx>sharedInformers</span><span class=p>.</span><span class=nf>ForResource</span><span class=p>(</span><span class=nx>resource</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>klog</span><span class=p>.</span><span class=nf>V</span><span class=p>(</span><span class=mi>4</span><span class=p>).</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;using a shared informer for resource %q, kind %q&#34;</span><span class=p>,</span> <span class=nx>resource</span><span class=p>.</span><span class=nf>String</span><span class=p>(),</span> <span class=nx>kind</span><span class=p>.</span><span class=nf>String</span><span class=p>())</span>
</span></span><span class=line><span class=cl>		<span class=c1>// need to clone because it&#39;s from a shared cache</span>
</span></span><span class=line><span class=cl>		<span class=nx>shared</span><span class=p>.</span><span class=nf>Informer</span><span class=p>().</span><span class=nf>AddEventHandlerWithResyncPeriod</span><span class=p>(</span><span class=nx>handlers</span><span class=p>,</span> <span class=nx>ResourceResyncTime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>shared</span><span class=p>.</span><span class=nf>Informer</span><span class=p>().</span><span class=nf>GetController</span><span class=p>(),</span> <span class=nx>shared</span><span class=p>.</span><span class=nf>Informer</span><span class=p>().</span><span class=nf>GetStore</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>//è·å–èµ„æºå¯¹è±¡æ—¶å‡ºé”™ä¼šåˆ°è¿™é‡Œ,æ¯”å¦‚ék8så†…ç½®RedisClusterã€clusterbasesã€clustersã€esclustersã€volumeprovidersã€stsmastersã€appappsã€mysqlclustersã€brokerclustersã€clustertemplates;</span>
</span></span><span class=line><span class=cl>		<span class=c1>//å†…ç½®çš„networkPoliciesã€apiservicesã€customresourcedefinitions</span>
</span></span><span class=line><span class=cl>		<span class=nx>klog</span><span class=p>.</span><span class=nf>V</span><span class=p>(</span><span class=mi>4</span><span class=p>).</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;unable to use a shared informer for resource %q, kind %q: %v&#34;</span><span class=p>,</span> <span class=nx>resource</span><span class=p>.</span><span class=nf>String</span><span class=p>(),</span> <span class=nx>kind</span><span class=p>.</span><span class=nf>String</span><span class=p>(),</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// TODO: consider store in one storage.</span>
</span></span><span class=line><span class=cl>	<span class=c1>// TODO: è€ƒè™‘å­˜å‚¨åœ¨ä¸€ä¸ªå­˜å‚¨ä¸­ã€‚</span>
</span></span><span class=line><span class=cl>	<span class=nx>klog</span><span class=p>.</span><span class=nf>V</span><span class=p>(</span><span class=mi>5</span><span class=p>).</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;create storage for resource %s&#34;</span><span class=p>,</span> <span class=nx>resource</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>//ä¸Šé¢å¤±è´¥çš„èµ„æºå¯¹è±¡çš„storeå’Œcontroller</span>
</span></span><span class=line><span class=cl>	<span class=nx>store</span><span class=p>,</span> <span class=nx>monitor</span> <span class=o>:=</span> <span class=nx>cache</span><span class=p>.</span><span class=nf>NewInformer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nf>listWatcher</span><span class=p>(</span><span class=nx>gb</span><span class=p>.</span><span class=nx>dynamicClient</span><span class=p>,</span> <span class=nx>resource</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=kc>nil</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>ResourceResyncTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=c1>// don&#39;t need to clone because it&#39;s not from shared cache</span>
</span></span><span class=line><span class=cl>		<span class=c1>//ä¸éœ€è¦å…‹éš†ï¼Œå› ä¸ºå®ƒä¸æ˜¯æ¥è‡ªå…±äº«ç¼“å­˜</span>
</span></span><span class=line><span class=cl>		<span class=nx>handlers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>monitor</span><span class=p>,</span> <span class=nx>store</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>è¯¥æ–¹æ³•ä¸»è¦åŠŸèƒ½æ˜¯ï¼š<br>1ã€å°†æ–°å¢ã€æ›´æ”¹ã€åˆ é™¤çš„èµ„æºå¯¹è±¡æ„å»ºä¸ºeventç»“æ„ä½“ï¼Œæ”¾å…¥GraphBuilderçš„graphChangesé˜Ÿåˆ—é‡Œï¼Œæœ€ç»ˆè¢«runProcessGraphChangesè¿™ä¸ªworkeræ¶ˆè´¹ï¼›<br>2ã€æ„å»ºå¤§å¤šæ•°å†…ç½®èµ„æºçš„SharedInformerFactoryï¼Œæ„å»ºå¤±è´¥çš„ç”¨cache.NewInformeræ„å»ºï¼ˆé€šè¿‡CRDå®šä¹‰çš„å¯¹è±¡ä»¥åŠéƒ¨åˆ†k8så†…ç½®å¯¹è±¡ï¼‰</p><p>ä»£ç ç»§ç»­å›åˆ°k8s.io\kubernetes\cmd\kube-controller-manager\app\core.goä¸­çš„<code>startGarbageCollectorController</code>ä¸­ï¼Œçœ‹<code> garbageCollector.Run(workers, ctx.Stop)</code>æ–¹æ³•ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>gc</span> <span class=o>*</span><span class=nx>GarbageCollector</span><span class=p>)</span> <span class=nf>Run</span><span class=p>(</span><span class=nx>workers</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>stopCh</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>utilruntime</span><span class=p>.</span><span class=nf>HandleCrash</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>gc</span><span class=p>.</span><span class=nx>attemptToDelete</span><span class=p>.</span><span class=nf>ShutDown</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>gc</span><span class=p>.</span><span class=nx>attemptToOrphan</span><span class=p>.</span><span class=nf>ShutDown</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>gc</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span><span class=p>.</span><span class=nx>graphChanges</span><span class=p>.</span><span class=nf>ShutDown</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>klog</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Starting garbage collector controller&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>klog</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Shutting down garbage collector controller&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//åç¨‹è¿è¡Œç”Ÿäº§è€…monitors</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nx>gc</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>stopCh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//ç­‰å¾…dependencyGraphBuilderç¼“å­˜å¼€å§‹åŒæ­¥</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>!</span><span class=nx>controller</span><span class=p>.</span><span class=nf>WaitForCacheSync</span><span class=p>(</span><span class=s>&#34;garbage collector&#34;</span><span class=p>,</span> <span class=nx>stopCh</span><span class=p>,</span> <span class=nx>gc</span><span class=p>.</span><span class=nx>dependencyGraphBuilder</span><span class=p>.</span><span class=nx>IsSynced</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//åƒåœ¾æ”¶é›†å™¨ï¼šæ‰€æœ‰èµ„æºç›‘è§†å™¨éƒ½å·²åŒæ­¥ã€‚ç»§ç»­æ”¶é›†åƒåœ¾</span>
</span></span><span class=line><span class=cl>	<span class=nx>klog</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Garbage collector: all resource monitors have synced. Proceeding to collect garbage&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// gc workers</span>
</span></span><span class=line><span class=cl>	<span class=c1>//åç¨‹è¿è¡Œæ¶ˆè´¹è€…DeleteWorkerså’ŒOrphanWorkers</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>workers</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>//é»˜è®¤å‚æ•°ä¸º20ä¸ªå¹¶å‘åç¨‹å°è¯•delete worker</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nx>wait</span><span class=p>.</span><span class=nf>Until</span><span class=p>(</span><span class=nx>gc</span><span class=p>.</span><span class=nx>runAttemptToDeleteWorker</span><span class=p>,</span> <span class=mi>1</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>,</span> <span class=nx>stopCh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=c1>//é»˜è®¤å‚æ•°ä¸º20ä¸ªå¹¶å‘åç¨‹å°è¯•orphan worker</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nx>wait</span><span class=p>.</span><span class=nf>Until</span><span class=p>(</span><span class=nx>gc</span><span class=p>.</span><span class=nx>runAttemptToOrphanWorker</span><span class=p>,</span> <span class=mi>1</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>,</span> <span class=nx>stopCh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=o>&lt;-</span><span class=nx>stopCh</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>gc.dependencyGraphBuilder.Run(stopCh)</code>ä¸»è¦åŠŸèƒ½ï¼š<br>1ã€gb.startMonitors()å¯åŠ¨ç›‘å¬èµ„æºå˜åŒ–çš„informerï¼›<br>2ã€wait.Until(gb.runProcessGraphChanges, 1*time.Second, stopCh)å¼€å¯ä»é˜Ÿåˆ—GraphBuilder.graphChangesä¸­æ¶ˆè´¹çš„worker</p><p>å¯åŠ¨20ä¸ªrunAttemptToDeleteWorkerå’Œ20ä¸ªrunAttemptToOrphanWorker</p><h2 class="relative group">å‚è€ƒ<div id=å‚è€ƒ class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%8f%82%e8%80%83 aria-label=é”šç‚¹>#</a></span></h2><p>k8så®˜æ–¹æ–‡æ¡£garbage-collectionè‹±æ–‡ç‰ˆï¼š<br><a href="https://kubeinfo.cn/go/?target=aHR0cHM6Ly9rdWJlcm5ldGVzLmlvL2RvY3MvY29uY2VwdHMvd29ya2xvYWRzL2NvbnRyb2xsZXJzL2dhcmJhZ2UtY29sbGVjdGlvbi8%3d" target=_blank>https://kubernetes.io/docs/concepts/workloads/controllers/garbage-collection/</a></p><p>ä¾èµ–å›¾æ ‡ç”Ÿæˆåº“gonum Apiæ–‡æ¡£ï¼š<br><a href="https://kubeinfo.cn/go/?target=aHR0cHM6Ly9nb2RvYy5vcmcvZ29udW0ub3JnL3YxL2dvbnVtL2dyYXBo" target=_blank>https://godoc.org/gonum.org/v1/gonum/graph</a></p><p>graphvizä¸‹è½½ï¼š<br><a href="https://kubeinfo.cn/go/?target=aHR0cHM6Ly9ncmFwaHZpei5naXRsYWIuaW8vX3BhZ2VzL0Rvd25sb2FkL0Rvd25sb2FkX3dpbmRvd3MuaHRtbA%3d%3d" target=_blank>https://graphviz.gitlab.io/_pages/Download/Download_windows.html</a></p></div><div class="text-neutral-700 dark:text-neutral-300" style=text-align:center;font-size:16px;font-family:cursive>-------ä»–æ—¥æ±Ÿæ¹–ç›¸é€¢
<span class="relative icon" style=display:inline-block><svg version="1.0" id="Layer_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="800" viewBox="0 0 64 64" enable-background="new 0 0 64 64"><g><path fill="#394240" d="M35 4.145V3.002 3c0-1.656-1.343-3-3-3s-3 1.344-3 3v.002 1.143C12.734 5.658.0 19.338.0 36c0 0 0 1 1 1s1.867-1 1.867-1C4.68 34.15 7.204 33 10 33c4.1.0 7.618 2.469 9.162 6 0 0 .541 1 1.838 1s1.838-1 1.838-1c1.15-2.629 3.396-4.668 6.162-5.539V56c0 4.418 3.582 8 8 8s8-3.582 8-8c0-1.656-1.343-3-3-3s-3 1.344-3 3c0 1.104-.896 2-2 2s-2-.896-2-2V33.461c2.766.871 5.012 2.91 6.162 5.539.0.0.541 1 1.838 1s1.838-1 1.838-1c1.544-3.531 5.062-6 9.162-6 2.796.0 5.319 1.15 7.133 3 0 0 .867 1 1.867 1s1-1 1-1C64 19.338 51.266 5.658 35 4.145zM31 3c0-.553.447-1 1-1s1 .447 1 1v1.025C32.667 4.016 32.335 4 32 4s-.667.016-1 .025V3zM10 31c-3.047.0-5.816 1.145-7.928 3.018C3.006 19.729 13.94 8.17 27.947 6.277 22.911 14.678 20 24.492 20 35v1.387C17.853 33.145 14.181 31 10 31zM37 60c2.209.0 4-1.791 4-4 0-.553.447-1 1-1s1 .447 1 1c0 3.312-2.687 6-6 6s-6-2.688-6-6V33.055C31.329 33.023 31.662 33 32 33s.671.023 1 .055V56c0 2.209 1.791 4 4 4zM32 31c-4.181.0-7.853 2.145-10 5.387V35c0-10.662 3.113-20.588 8.449-28.959.5-.025 1.004-.039 1.511-.039h.08c.507.0 1.011.014 1.511.039C38.887 14.412 42 24.338 42 35v1.387C39.853 33.145 36.181 31 32 31zm22 0c-4.181.0-7.853 2.145-10 5.387V35c0-10.508-2.911-20.322-7.947-28.723C50.06 8.17 60.994 19.729 61.928 34.018 59.816 32.145 57.047 31 54 31z"/><path fill="#f9ebb2" d="M31 3c0-.553.447-1 1-1s1 .447 1 1v1.025C32.667 4.016 32.335 4 32 4s-.667.016-1 .025V3z"/><g><path fill="#45aab8" d="M2.072 34.018C4.184 32.145 6.953 31 10 31c4.181.0 7.853 2.145 10 5.387V35c0-10.508 2.911-20.322 7.947-28.723C13.94 8.17 3.006 19.729 2.072 34.018z"/><path fill="#45aab8" d="M36.053 6.277C41.089 14.678 44 24.492 44 35v1.387C46.147 33.145 49.819 31 54 31c3.047.0 5.816 1.145 7.928 3.018C60.994 19.729 50.06 8.17 36.053 6.277z"/></g><path fill="#b4ccb9" d="M32.04 6.002h-.08c-.507.0-1.011.014-1.511.039C25.113 14.412 22 24.338 22 35v1.387C24.147 33.145 27.819 31 32 31s7.853 2.145 10 5.387V35c0-10.662-3.113-20.588-8.449-28.959C33.051 6.016 32.547 6.002 32.04 6.002z"/><path fill="#f9ebb2" d="M37 60c2.209.0 4-1.791 4-4 0-.553.447-1 1-1s1 .447 1 1c0 3.312-2.687 6-6 6s-6-2.688-6-6V33.055C31.329 33.023 31.662 33 32 33s.671.023 1 .055V56c0 2.209 1.791 4 4 4z"/></g></svg>
</span>å†å½“æ¯é…’è¨€æ¬¢-------</div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;title=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="åˆ†äº«åˆ° LinkedIn" aria-label="åˆ†äº«åˆ° LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;text=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="åˆ†äº«åˆ° Twitter" aria-label="åˆ†äº«åˆ° Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;resubmit=true&amp;title=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="æäº¤åˆ° Reddit" aria-label="æäº¤åˆ° Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;resubmit=true&amp;title=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="åˆ†äº«åˆ° WhatsApp" aria-label="åˆ†äº«åˆ° WhatsApp"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;resubmit=true&amp;title=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="åˆ†äº«åˆ° Telegram" aria-label="åˆ†äº«åˆ° Telegram"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;description=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="é’‰åˆ° Pinterest" aria-label="é’‰åˆ° Pinterest"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;quote=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title="åˆ†äº«åˆ° Facebook" aria-label="åˆ†äº«åˆ° Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://kubeinfo.cn/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%80/&amp;subject=kubernetes%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6%e5%99%a8GarbageCollector%e6%8e%a7%e5%88%b6%e5%99%a8%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90%ef%bc%88%e4%b8%80%ef%bc%89" title=é€šè¿‡ç”µå­é‚®ä»¶å‘é€ aria-label=é€šè¿‡ç”µå­é‚®ä»¶å‘é€><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section></div><script>var oid="views_posts/kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æä¸€.md",oid_likes="likes_posts/kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æä¸€.md"</script><script type=text/javascript src=/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span></span><span><a class="flex text-right group ml-3" href=/posts/kubernetes%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8garbagecollector%E6%8E%A7%E5%88%B6%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%BA%8C/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">kubernetesåƒåœ¾å›æ”¶å™¨GarbageCollectoræ§åˆ¶å™¨æºç åˆ†æï¼ˆäºŒï¼‰</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2019-10-16T23:29:12+00:00>2019å¹´10æœˆ16æ—¥</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div><div class=pt-3><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=pt-3><script type=text/javascript>var lazyadsense=!1;window.addEventListener("scroll",function(){(0!=document.documentElement.scrollTop&&!1===lazyadsense||0!=document.body.scrollTop&&!1===lazyadsense)&&(!function(){var t,e=document.createElement("script");e.id="g_ads_js",e.type="text/javascript",e.async="async",e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3925981084585036",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}(),lazyadsense=!0)},!0)</script><script>(adsbygoogle=window.adsbygoogle||[]).onload=function(){[].forEach.call(document.getElementsByClassName("adsbygoogle"),function(){adsbygoogle.push({})})}</script><div style="min-height=250px"><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-3925981084585036 data-ad-slot=4806125422 data-ad-format=auto data-full-width-responsive=true></ins></div><img style=margin-top:1.5em loading=lazy src=/img/wechat-official-account.jpg alt=å…¬ä¼—å·äºŒç»´ç ><div id=comment></div><script>document.addEventListener("DOMContentLoaded",function(){var t="/js/iDisqus.min.js",e=new IntersectionObserver(function(n){if(n[0].isIntersecting){var s,o=document.createElement("link");o.rel="stylesheet",o.href="/css/iDisqus.min.css",document.head.appendChild(o),s=document.createElement("script"),s.src=t,s.onload=function(){var e=new iDisqus("comment",{forum:"fuckcloudnative",api:"https://disqus.kubeinfo.cn",site:"https://kubeinfo.cn",emojiPath:"https://images.kubeinfo.cn/emoji/",mode:2,timeout:15,init:!0})},document.body.appendChild(s),e.disconnect()}},{threshold:[.1]});e.observe(document.getElementById("comment"))})</script></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=è¿”å›é¡¶éƒ¨ title=è¿”å›é¡¶éƒ¨>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden" style=margin-inline:auto;text-align:center><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>æ ‡ç­¾</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/categories/ title=Categories>åˆ†ç±»</a></li></ul></nav><div class="flex items-center justify-between"></div><script type=text/javascript src=/lib/zoom/zoom.min.min.9727c53d7324a2d82edc7b1192627812e49f1352d0d1f81ca140754cd7b8081a123c5f0924c0c5e2860baa5dd7df12c7283877bbba916620bb07c12401a7c281.js integrity="sha512-lyfFPXMkotgu3HsRkmJ4EuSfE1LQ0fgcoUB1TNe4CBoSPF8JJMDF4oYLql3X3xLHKDh3u7qRZiC7B8EkAafCgQ=="></script><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script><div class=busuanzi style=margin-inline:auto;text-align:center><div class=busuanzi__item><span class="busuanzi__item--label text-neutral-500 dark:text-neutral-400">æ€»è®¿å®¢</span>
<span id=busuanzi_site_uv class="busuanzi__item--number text-neutral-500 dark:text-neutral-400"></span></div><div class=busuanzi__item><span class="busuanzi__item--label text-neutral-500 dark:text-neutral-400">æ€»æµè§ˆé‡</span>
<span id=busuanzi_site_pv class="busuanzi__item--number text-neutral-500 dark:text-neutral-400"></span></div></div><p class="text-sm text-neutral-500 dark:text-neutral-400" style=margin-inline:auto;text-align:center>&copy; 2025<br>æœ¬ç«™å†…å®¹ä¾æ®
<a href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh target=_blank>CC BY-SA 4.0</a>
è®¸å¯è¯è¿›è¡Œæˆæƒï¼Œè½¬è½½è¯·é™„ä¸Šå‡ºå¤„é“¾æ¥ã€‚</p><div class=github-badge><span class=badge-subject>æ„å»ºå·¥å…·</span><span class="badge-value bg-blue"><a style=color:#fff href=https://gohugo.io/ target=_blank>Hugo v0.144.0</a></span>
<span class=badge-subject>æ‰˜ç®¡äº</span><span class="badge-value bg-brightgreen"><a style=color:#fff href=https://sealos.run target=_blank>Sealos</a></span>
<span class=badge-subject>CDN</span><span class="badge-value bg-blueviolet"><a style=color:#fff href=https://vercel.com target=_blank>Vercel</a></span>
<span class=badge-subject>å›¾åºŠ</span><span class="badge-value bg-orange"><a style=color:#fff href=https://www.jsdelivr.com/ target=_blank>jsDelivr</a></span>
<span class=badge-subject>ä¸»é¢˜</span><span class="badge-value bg-blue"><a style=color:#fff href=https://github.com/nunocoracao/blowfish target=_blank>Blowfish</a></span></div><section class="text-sm text-neutral-500 dark:text-neutral-400"><span id=span_dt_dt></span><script defer language=javascript>var uptime_1="æœ¬ç«™å·²ç»å¼€å¿ƒè¿è¡Œ ",uptime_2=" å¤© ",uptime_3=" å°æ—¶ ",uptime_4=" åˆ† ",uptime_5=" ç§’";function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("10/30/2020 21:30:15"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=24*60*60*1e3,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=(e_daysold-daysold)*24,hrsold=Math.floor(e_hrsold),e_minsold=(e_hrsold-hrsold)*60,minsold=Math.floor((e_hrsold-hrsold)*60),seconds=Math.floor((e_minsold-minsold)*60),span_dt_dt.innerHTML=uptime_1+daysold+uptime_2+hrsold+uptime_3+minsold+uptime_4+seconds+uptime_5}show_date_time()</script></section><style>.wxtip{background:rgba(0,0,0,.8);text-align:center;position:fixed;left:0;top:0;width:100%;height:100%;z-index:998;display:none}.wxtip-icon{width:52px;height:67px;background:url(img/weixin-tip.png)no-repeat;display:block;position:absolute;right:20px;top:20px}.wxtip-txt{margin-top:107px;color:#fff;font-size:16px;line-height:1.5}</style><div class=wxtip id=JweixinTip><span class=wxtip-icon></span><p class=wxtip-txt>ç‚¹å‡»å±å¹•å³ä¸Šè§’çš„ Â·Â·Â·<br>åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹© <span style=color:red>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</span></p><br><br><p><img loading=lazy style=width:85%;border-radius:10px;display:block;margin-left:auto;margin-right:auto src=/img/wechat-browser.jpg></p></div><script defer>is_weixn_qq()&&(document.getElementById("JweixinTip").style.display="block",document.getElementById("container").style.display="none",document.getElementById("top-grrk").style.display="none");function is_weixn_qq(){var e=navigator.userAgent,t=!!/MicroMessenger/i.test(e),n=!!/QQ\//i.test(e);return!!(t||n)}</script><script defer src=https://wvprxbiaqrgp.hzh.sealos.run/js></script><script>document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("busuanzi_site_uv"),o=document.getElementById("busuanzi_site_pv"),e=new MutationObserver(t=>{for(let n of t)if(n.type==="childList"){e.disconnect(),n.target.innerHTML=parseInt(n.target.innerHTML)+731632;break}}),t=new MutationObserver(e=>{for(let n of e)if(n.type==="childList"){t.disconnect(),n.target.innerHTML=parseInt(n.target.innerHTML)+1360325;break}}),n={childList:!0};e.observe(s,n),t.observe(o,n)})</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",e=>{var n=["Docker","Containerd","Podman","Kubernetes","KubeEdge","Prometheus","KubeSphere","FastGPT","Envoy","eBPF","KubeNative","Webassembly","WireGuard","Tailscale","Cloud Native"],t=0;document.body.addEventListener("click",function(e){var s,o,i,a,r,l=n[t];t=(t+1)%n.length,s=document.createElement("span"),s.textContent=l,s.style.cssText=`
            z-index: 9999;
            top: ${e.pageY-20}px;
            left: ${e.pageX}px;
            position: absolute;
            font-weight: bold;
            color: ${randomColor()};
            opacity: 1;
            transition: opacity 1.5s;
        `,document.body.appendChild(s),o=null,a=1500,i=e.pageY-20,r=i-160;function c(e){o===null&&(o=e);var t=(e-o)/a;t<1?(s.style.top=i-t*(i-r)+"px",requestAnimationFrame(c)):s.remove()}requestAnimationFrame(c)})});function randomColor(){var e=["#FFDA65","#00BFFF","#cb80ff","#acc2ef","#87CEEB","#FFB6C1"];return e[Math.floor(Math.random()*e.length)]}</script><script>document.addEventListener("DOMContentLoaded",function(){var e=function(e,t){e.forEach(function(e){if(e.isIntersecting){var n=e.target,s=n.getAttribute("data-bg");n.style.backgroundImage="url('"+s+"')",t.unobserve(e.target)}})},t=new IntersectionObserver(e),n=document.querySelectorAll(".thumbnail_card_related, .thumbnail_card");n.forEach(function(e){t.observe(e)})})</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://kubeinfo.cn/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=æœç´¢ tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="å…³é—­ (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div><div class="bg fixed top-0 left-0 h-screen w-screen"></div></body></html>